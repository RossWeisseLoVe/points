var R=Object.defineProperty,N=Object.defineProperties;var $=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var b=Object.prototype.hasOwnProperty,k=Object.prototype.propertyIsEnumerable;var B=(t,r,e)=>r in t?R(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,F=(t,r)=>{for(var e in r||(r={}))b.call(r,e)&&B(t,e,r[e]);if(_)for(var e of _(r))k.call(r,e)&&B(t,e,r[e]);return t},M=(t,r)=>N(t,$(r));var f=(t,r,e)=>new Promise((c,a)=>{var d=o=>{try{i(e.next(o))}catch(m){a(m)}},n=o=>{try{i(e.throw(o))}catch(m){a(m)}},i=o=>o.done?c(o.value):Promise.resolve(o.value).then(d,n);i((e=e.apply(t,r)).next())});import{B as S,a as V}from"./index-6bb63bf0.js";import{_ as E}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as A}from"./useForm-d2875f1c.js";import{f as C}from"./app.data-d7596be6.js";import{c as L,s as O}from"./app-72ac4173.js";import{F as U}from"./constantEnum-c819fa5f.js";import{d as j,f as x,u as g,c as D,a6 as w,Z as T,a7 as q,a8 as G,l as I,ab as W}from"./vue-f7f38239.js";import{c as Z}from"./index.js";import"./antd-bebda08e.js";import"./useWindowSizeFn-01ffbee2.js";import"./index-1b9aa1da.js";import"./uuid-31b8b5a4.js";import"./useSortable-9ec2a7be.js";import"./download-2647fd8d.js";import"./base64Conver-39fc0d26.js";import"./index-b34be3ab.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-af62677b.js";import"./copyTextToClipboard-ad844e61.js";import"./index-091b1c05.js";const z=j({name:"AppModal",components:{BasicModal:S,BasicForm:E},emits:["success","register"],setup(t,{emit:r}){const e=x(!0),[c,{resetFields:a,updateSchema:d,setFieldsValue:n,validate:i}]=A({labelWidth:100,schemas:C,showActionButtonGroup:!1}),o=s=>[{trigger:"blur",validator:(l,h)=>h?L({id:s.id,field:s.field,fieldValue:h,fieldName:s.fieldName}).then(u=>u?Promise.resolve():Promise.reject(s.fieldName+"已存在，请修改！")).catch(u=>Promise.reject(u)):Promise.resolve()}],[m,{setModalProps:p,closeModal:y}]=V(s=>f(this,null,function*(){yield a(),p({confirmLoading:!1}),e.value=!!(s!=null&&s.isUpdate);let l=s.record;yield d([{field:"sn",dynamicRules:()=>[{required:!0,whitespace:!0,message:"标识不能为空！"},{pattern:new RegExp(U.SN),type:"string",message:"请输入英文或数字！"},{max:40,message:"字符长度不能大于40！"},...o({id:g(e)&&l&&l.id||"",field:"sn",fieldValue:"",fieldName:"标识"})]}]),g(e)&&n(M(F({},l),{status:l.status===1}))})),v=D(()=>g(e)?"修改":"新增");function P(){return f(this,null,function*(){try{p({confirmLoading:!0});const s=yield i();s.status=s.status?1:0,yield O(s),y(),r("success")}finally{p({confirmLoading:!1})}})}return{registerModal:m,registerForm:c,getTitle:v,handleSubmit:P}}});function H(t,r,e,c,a,d){const n=w("BasicForm"),i=w("BasicModal");return T(),q(i,W(t.$attrs,{onRegister:t.registerModal,title:t.getTitle,onOk:t.handleSubmit}),{default:G(()=>[I(n,{onRegister:t.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const he=Z(z,[["render",H]]);export{he as default};
