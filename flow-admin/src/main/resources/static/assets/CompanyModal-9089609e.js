var B=Object.defineProperty,q=Object.defineProperties;var C=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,F=Object.prototype.propertyIsEnumerable;var w=(t,s,e)=>s in t?B(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,_=(t,s)=>{for(var e in s||(s={}))N.call(s,e)&&w(t,e,s[e]);if(b)for(var e of b(s))F.call(s,e)&&w(t,e,s[e]);return t},I=(t,s)=>q(t,C(s));var f=(t,s,e)=>new Promise((l,r)=>{var m=o=>{try{n(e.next(o))}catch(d){r(d)}},i=o=>{try{n(e.throw(o))}catch(d){r(d)}},n=o=>o.done?l(o.value):Promise.resolve(o.value).then(m,i);n((e=e.apply(t,s)).next())});import{B as k,a as v}from"./index-6bb63bf0.js";import{_ as R}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as S}from"./useForm-d2875f1c.js";import{m as $,d as T,f as O,u as g,c as V,a6 as x,Z as j,a7 as A,a8 as D,l as E,ab as L}from"./vue-f7f38239.js";import{Q as U}from"./antd-bebda08e.js";import{c as z,s as W}from"./company-7689c9fc.js";import{c as Z}from"./index.js";const ne=[{title:"全称",dataIndex:"cname",align:"left"},{title:"编码",dataIndex:"code",align:"left",width:100},{title:"简称",dataIndex:"shortName",align:"left",width:180},{title:"状态",dataIndex:"status",width:80,customRender:({record:t})=>{const e=~~t.status===1,l=e?"green":"red",r=e?"启用":"停用";return $(U,{color:l},()=>r)}},{title:"排序",dataIndex:"orderNo",align:"left",width:80},{title:"创建时间",dataIndex:"createTime",width:180},{title:"描述",dataIndex:"descr",align:"left"}],le=[{field:"keyword",label:"关键字",component:"Input",componentProps:{placeholder:"请输入名称/编码"},labelWidth:60,colProps:{span:6,lg:{span:6,offset:0},sm:{span:10,offset:0},xs:{span:16,offset:0}}}],G=[{field:"id",label:"ID",component:"Input",show:!1},{field:"pid",label:"pid",required:!1,component:"Input",show:!1},{field:"cname",label:"全称",required:!0,component:"Input",rules:[{required:!0,whitespace:!0,message:"全称不能为空！"},{max:64,message:"字符长度不能大于64！"}],colProps:{span:24}},{field:"shortName",label:"简称",required:!1,component:"Input",rules:[{required:!0,whitespace:!0,message:"简称不能为空！"},{max:64,message:"字符长度不能大于64！"}],colProps:{span:24}},{field:"code",label:"编码",required:!0,component:"Input",colProps:{span:24}},{field:"orderNo",label:"排序号",required:!1,component:"InputNumber"},{field:"status",label:"状态",required:!1,component:"Switch",defaultValue:!0,componentProps:{checkedChildren:"启用",unCheckedChildren:"禁用"},colProps:{span:24}},{field:"descr",label:"描述",required:!1,component:"InputTextArea",rules:[{max:200,message:"字符长度不能大于64！"}],colProps:{span:24}}],Q=T({name:"CompanyModal",components:{BasicModal:k,BasicForm:R},emits:["success","register"],setup(t,{emit:s}){const e=O(!0),[l,{resetFields:r,updateSchema:m,setFieldsValue:i,validate:n}]=S({labelWidth:100,schemas:G,showActionButtonGroup:!1}),o=a=>[{trigger:"blur",validator:(c,h)=>h?z({id:a.id,field:a.field,fieldValue:h,fieldName:a.fieldName}).then(p=>p?Promise.resolve():Promise.reject(a.fieldName+"已存在，请修改！")).catch(p=>Promise.reject(p)):Promise.resolve()}],[d,{setModalProps:u,closeModal:P}]=v(a=>f(this,null,function*(){yield r(),u({confirmLoading:!1}),e.value=!!(a!=null&&a.isUpdate);let c=a.record;yield m([{field:"code",dynamicRules:()=>[{required:!0,whitespace:!0,message:"编码不能为空！"},{pattern:new RegExp("^[0-9a-zA-Z_]{1,}$"),type:"string",message:"请输入英文或数字！"},{max:64,message:"字符长度不能大于64！"},...o({id:g(e)&&c&&c.id||"",field:"code",fieldValue:"",fieldName:"编码"})]}]),g(e)&&i(I(_({},c),{status:c.status===1}))})),y=V(()=>g(e)?"修改":"新增");function M(){return f(this,null,function*(){try{u({confirmLoading:!0});const a=yield n();a.status=a.status?1:0,yield W(a),P(),s("success")}finally{u({confirmLoading:!1})}})}return{registerModal:d,registerForm:l,getTitle:y,handleSubmit:M}}});function H(t,s,e,l,r,m){const i=x("BasicForm"),n=x("BasicModal");return j(),A(n,L(t.$attrs,{onRegister:t.registerModal,title:t.getTitle,onOk:t.handleSubmit}),{default:D(()=>[E(i,{onRegister:t.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const J=Z(Q,[["render",H]]),ie=Object.freeze(Object.defineProperty({__proto__:null,default:J},Symbol.toStringTag,{value:"Module"}));export{J as C,ie as a,ne as c,le as s};
