var P=Object.defineProperty;var _=Object.getOwnPropertySymbols;var q=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var b=(o,t,e)=>t in o?P(o,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[t]=e,M=(o,t)=>{for(var e in t||(t={}))q.call(t,e)&&b(o,e,t[e]);if(_)for(var e of _(t))R.call(t,e)&&b(o,e,t[e]);return o};var h=(o,t,e)=>new Promise((c,a)=>{var d=s=>{try{i(e.next(s))}catch(l){a(l)}},n=s=>{try{i(e.throw(s))}catch(l){a(l)}},i=s=>s.done?c(s.value):Promise.resolve(s.value).then(d,n);i((e=e.apply(o,t)).next())});import{B as S,a as $}from"./index-6bb63bf0.js";import{_ as v}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as C}from"./useForm-d2875f1c.js";import{f as N}from"./modelInfo-bc19c532.js";import{a as k}from"./app-72ac4173.js";import{aN as L,c as D}from"./index.js";import{d as V,f as x,u as y,c as A,a6 as B,Z as E,a7 as K,a8 as O,l as j,ab as G}from"./vue-f7f38239.js";import"./antd-bebda08e.js";import"./useWindowSizeFn-01ffbee2.js";import"./index-1b9aa1da.js";import"./uuid-31b8b5a4.js";import"./useSortable-9ec2a7be.js";import"./download-2647fd8d.js";import"./base64Conver-39fc0d26.js";import"./index-b34be3ab.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-af62677b.js";import"./copyTextToClipboard-ad844e61.js";import"./index-091b1c05.js";const T=[{field:"id",label:"ID",required:!1,component:"Input",show:!1},{field:"categoryCode",label:"ID",required:!1,component:"Input",show:!1},{field:"name",label:"名称",component:"Input",required:!0,rules:[{required:!0,whitespace:!0,message:"名称不能为空！"},{max:200,message:"字符长度不能大于200！"}]},{field:"modelKey",label:"标识",component:"Input",required:!0},{field:"appSn",label:"所属系统",component:"Select",componentProps:{getPopupContainer:()=>document.body},required:!0}],U=V({name:"ModelInfoModal",components:{BasicModal:S,BasicForm:v},emits:["success","register"],setup(o,{emit:t}){const e=x(!0);L();const[c,{setFieldsValue:a,updateSchema:d,resetFields:n,validate:i}]=C({labelWidth:100,schemas:T,showActionButtonGroup:!1,actionColOptions:{span:23}}),s=r=>[{trigger:"blur",validator:(f,m)=>m?N({id:r.id,field:r.field,fieldValue:m,fieldName:r.fieldName}).then(g=>g?Promise.resolve():Promise.reject(r.fieldName+"已存在，请修改！")).catch(g=>Promise.reject(g)):Promise.resolve()}],[l,{setModalProps:p,changeLoading:u,closeModal:w}]=$(r=>h(this,null,function*(){n(),p({confirmLoading:!1}),e.value=!!(r!=null&&r.isUpdate),u(!0);let f=null;try{f=yield k()}finally{u(!1)}let m=r.record;yield d([{field:"appSn",componentProps:{options:f,labelField:"id"}},{field:"modelKey",dynamicRules:()=>[{required:!0,whitespace:!0,message:"编码不能为空！"},{pattern:new RegExp("^[0-9a-zA-Z_]{1,}$"),type:"string",message:"请输入英文或数字！"},{max:150,message:"字符长度不能大于150！"},...s({id:y(e)&&m&&m.id||"",field:"modelKey",fieldValue:"",fieldName:"编码"})]}]),y(e)&&a(M({},r.record))})),F=A(()=>y(e)?"编辑":"新增");function I(){return h(this,null,function*(){try{p({confirmLoading:!0});const r=yield i();w(),t("success")}finally{u(!1),p({confirmLoading:!1})}})}return{registerModal:l,registerForm:c,getTitle:F,handleSubmit:I}}});function Z(o,t,e,c,a,d){const n=B("BasicForm"),i=B("BasicModal");return E(),K(i,G(o.$attrs,{onRegister:o.registerModal,title:o.getTitle,onOk:o.handleSubmit}),{default:O(()=>[j(n,{onRegister:o.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const ue=D(U,[["render",Z]]);export{ue as default};
