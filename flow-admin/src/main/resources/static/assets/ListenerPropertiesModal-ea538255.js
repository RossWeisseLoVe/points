var w=Object.defineProperty;var f=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var g=(o,s,e)=>s in o?w(o,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[s]=e,h=(o,s)=>{for(var e in s||(s={}))P.call(s,e)&&g(o,e,s[e]);if(f)for(var e of f(s))$.call(s,e)&&g(o,e,s[e]);return o};var d=(o,s,e)=>new Promise((n,i)=>{var m=a=>{try{t(e.next(a))}catch(p){i(p)}},l=a=>{try{t(e.throw(a))}catch(p){i(p)}},t=a=>a.done?n(a.value):Promise.resolve(a.value).then(m,l);t((e=e.apply(o,s)).next())});import{B as L,a as R}from"./index-6bb63bf0.js";import{_ as k}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as C}from"./useForm-d2875f1c.js";import{p as S,b as T}from"./flowListener-2ad3f78d.js";import{d as x,f as O,c as U,u as V,a6 as v,Z as q,a7 as A,a8 as D,l as E,ab as G}from"./vue-f7f38239.js";import{c as I}from"./index.js";import"./antd-bebda08e.js";import"./useWindowSizeFn-01ffbee2.js";import"./index-1b9aa1da.js";import"./uuid-31b8b5a4.js";import"./useSortable-9ec2a7be.js";import"./download-2647fd8d.js";import"./base64Conver-39fc0d26.js";import"./index-b34be3ab.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-af62677b.js";import"./copyTextToClipboard-ad844e61.js";import"./index-091b1c05.js";const N=x({name:"ListenerPropertiesModal",components:{BasicModal:L,BasicForm:k},emits:["success","register"],setup(o,{emit:s}){const e=O(!0);let n=[{label:"字符串",value:"string"},{label:"表达式",value:"expression"}],i={};n.forEach(r=>{i[r.value]=r.label});const[m,{resetFields:l,updateSchema:t,setFieldsValue:a,validate:p}]=C({labelWidth:100,schemas:S,showActionButtonGroup:!1}),[_,{setModalProps:c,closeModal:M}]=R(r=>d(this,null,function*(){yield l(),c({confirmLoading:!1}),e.value=!!(r!=null&&r.isUpdate);let B=r.record;t({field:"value",label:i[B.type]}),yield t([{field:"type",componentProps:{options:n,onChange:u=>{let F=typeof u=="string"?u:u.target.value;t({field:"value",label:i[F]})}}},{field:"name",dynamicRules:()=>[{required:!0,whitespace:!0,message:"标识不能为空！"},{max:80,message:"字符长度不能大于80！"}]}]),a(h({},r.record))})),b=U(()=>V(e)?"修改":"新增");function y(){return d(this,null,function*(){try{c({confirmLoading:!0});const r=yield p();yield T(r),M(),s("success")}finally{c({confirmLoading:!1})}})}return{registerModal:_,registerForm:m,getTitle:b,handleSubmit:y}}});function W(o,s,e,n,i,m){const l=v("BasicForm"),t=v("BasicModal");return q(),A(t,G(o.$attrs,{onRegister:o.registerModal,title:o.getTitle,onOk:o.handleSubmit}),{default:D(()=>[E(l,{onRegister:o.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const me=I(N,[["render",W]]);export{me as default};
