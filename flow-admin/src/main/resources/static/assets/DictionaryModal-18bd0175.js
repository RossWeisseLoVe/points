var v=Object.defineProperty;var h=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var _=(t,r,e)=>r in t?v(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,y=(t,r)=>{for(var e in r||(r={}))P.call(r,e)&&_(t,e,r[e]);if(h)for(var e of h(r))$.call(r,e)&&_(t,e,r[e]);return t};var f=(t,r,e)=>new Promise((c,a)=>{var l=i=>{try{s(e.next(i))}catch(m){a(m)}},n=i=>{try{s(e.throw(i))}catch(m){a(m)}},s=i=>i.done?c(i.value):Promise.resolve(i.value).then(l,n);s((e=e.apply(t,r)).next())});import{B as N,a as b}from"./index-6bb63bf0.js";import{_ as k}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as E}from"./useForm-d2875f1c.js";import{f as S,g as V,h as C}from"./dictionary-0bba14e5.js";import{F as D}from"./constantEnum-c819fa5f.js";import{d as O,f as L,u as B,c as U,a6 as F,Z as j,a7 as x,a8 as T,l as q,ab as A}from"./vue-f7f38239.js";import{c as G}from"./index.js";import"./antd-bebda08e.js";import"./useWindowSizeFn-01ffbee2.js";import"./index-1b9aa1da.js";import"./uuid-31b8b5a4.js";import"./useSortable-9ec2a7be.js";import"./download-2647fd8d.js";import"./base64Conver-39fc0d26.js";import"./index-b34be3ab.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-af62677b.js";import"./copyTextToClipboard-ad844e61.js";import"./index-091b1c05.js";const I=O({name:"DictionaryModal",components:{BasicModal:N,BasicForm:k},emits:["success","register"],setup(t,{emit:r}){const e=L(!0),[c,{setFieldsValue:a,updateSchema:l,resetFields:n,validate:s}]=E({labelWidth:100,schemas:S,showActionButtonGroup:!1,actionColOptions:{span:23}}),i=o=>[{trigger:"blur",validator:(p,g)=>g?V({id:o.id,field:o.field,fieldValue:g,fieldName:o.fieldName}).then(u=>u?Promise.resolve():Promise.reject(o.fieldName+"已存在，请修改！")).catch(u=>Promise.reject(u)):Promise.resolve()}],[m,{setModalProps:d,closeModal:M}]=b(o=>f(this,null,function*(){yield n(),d({confirmLoading:!1}),e.value=!!(o!=null&&o.isUpdate);let p=o.record;yield l([{field:"code",dynamicRules:()=>[{whitespace:!0,required:!0,message:"编码不能为空！"},{pattern:new RegExp(D.SN),type:"string",message:"请输入英文或数字！"},{pattern:new RegExp("^.{1,32}$"),type:"string",message:"字符长度不能大于32！"},...i({id:B(e)&&p&&p.id||"",field:"code",fieldValue:"",fieldName:"编码"})]}]),a(y({},o.record))})),w=U(()=>B(e)?"修改":"新增");function R(){return f(this,null,function*(){try{d({confirmLoading:!0});const o=yield s();yield C(o),M(),r("success")}finally{d({confirmLoading:!1})}})}return{registerModal:m,registerForm:c,getTitle:w,handleSubmit:R}}});function W(t,r,e,c,a,l){const n=F("BasicForm"),s=F("BasicModal");return j(),x(s,A(t.$attrs,{onRegister:t.registerModal,title:t.getTitle,onOk:t.handleSubmit}),{default:T(()=>[q(n,{onRegister:t.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const pe=G(I,[["render",W]]);export{pe as default};
