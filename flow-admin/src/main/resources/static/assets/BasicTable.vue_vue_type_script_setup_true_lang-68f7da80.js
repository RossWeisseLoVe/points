var Nt=Object.defineProperty,zt=Object.defineProperties;var Lt=Object.getOwnPropertyDescriptors;var Xe=Object.getOwnPropertySymbols;var Mt=Object.prototype.hasOwnProperty,Ut=Object.prototype.propertyIsEnumerable;var Ye=(n,a,t)=>a in n?Nt(n,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[a]=t,F=(n,a)=>{for(var t in a||(a={}))Mt.call(a,t)&&Ye(n,t,a[t]);if(Xe)for(var t of Xe(a))Ut.call(a,t)&&Ye(n,t,a[t]);return n},me=(n,a)=>zt(n,Lt(a));var Y=(n,a,t)=>new Promise((s,l)=>{var i=c=>{try{g(t.next(c))}catch(o){l(o)}},d=c=>{try{g(t.throw(c))}catch(o){l(o)}},g=c=>c.done?s(c.value):Promise.resolve(c.value).then(i,d);g((t=t.apply(n,a)).next())});import{d as ee,Z as $,_ as de,N as Ce,E as re,a0 as U,l as T,u as e,c as P,f as N,w as be,H as we,m as je,r as rt,h as Ge,o as We,x as $e,am as Vt,J as ut,a6 as ft,a7 as j,a8 as R,$ as fe,a1 as ve,aa as X,F as jt,a9 as Ve,n as dt,z as gt,af as Gt,e as Wt,ac as et,ah as Ke,ai as Be,ab as tt}from"./vue-f7f38239.js";import{_ as qt}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import{P as qe,k as Jt,D as Zt,I as Ae,A as ze,R as ue,F as Qt,u as Oe,l as Xt}from"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as Yt}from"./useForm-d2875f1c.js";import{a1 as nt,f as xe,h as _e,J as Ne,O as en,a2 as tn,D as nn,I as an,a3 as ln,Z as on,y as at,a4 as ht,a5 as sn,G as cn,c as rn,r as Ue,E as un,P as fn,S as dn}from"./index.js";import{aI as gn,ah as pe,aJ as hn,aK as mn,f as Se,e as q,k as Le,a as pn,aL as Cn,aM as vn,ae as lt,o as Je,aH as Sn,a4 as De,aN as bn,T as Te,a5 as mt,aO as wn,d as ot,D as yn,x as He,aP as _n,aQ as Rn,aD as Tn,aC as xn,a2 as In,aR as kn}from"./antd-bebda08e.js";import{a as Fn,u as pt,b as Pn,c as Dn,d as $n}from"./TableImg.vue_vue_type_style_index_0_lang-c025c7d6.js";import{b as st}from"./uuid-31b8b5a4.js";import An from"./sortable.esm-4ae27e0b.js";const On={class:"edit-header-cell"},ct=ee({name:"EditTableHeaderIcon",__name:"EditTableHeaderIcon",props:{title:{type:String,default:""}},setup(n){return(a,t)=>($(),de("span",On,[Ce(a.$slots,"default"),re(" "+U(n.title)+" ",1),T(e(gn))]))}}),En=ee({name:"TableHeaderCell",components:{EditTableHeaderCell:ct,BasicHelp:nt},props:{column:{type:Object,default:()=>({})}},setup(n){const{prefixCls:a}=xe("basic-table-header-cell"),t=P(()=>{var i;return!!((i=n.column)!=null&&i.edit)}),s=P(()=>{var d;const i=n.column;return typeof i.customHeaderRender=="function"?i.customHeaderRender(i):(i==null?void 0:i.customTitle)||((d=n.column)==null?void 0:d.title)}),l=P(()=>{var i;return(i=n.column)==null?void 0:i.helpMessage});return()=>T("div",null,[t.value?T(ct,null,{default:()=>[s.value]}):T("span",{class:"default-header-cell"},[s.value]),l.value&&T(nt,{text:l.value,class:`${a}__help`},null)])}});function Kn({page:n,type:a,originalElement:t}){return a==="prev"?n===0?null:T(hn,null,null):a==="next"?n===1?null:T(mn,null,null):t}function Bn(n){const{t:a}=_e(),t=N({}),s=N(!0);be(()=>e(n).pagination,o=>{!pe(o)&&o&&(t.value=F(F({},e(t)),o!=null?o:{}))});const l=P(()=>{const{pagination:o}=e(n);return!e(s)||pe(o)&&!o?!1:F(F({current:1,size:"small",defaultPageSize:qe,showTotal:w=>a("component.table.total",{total:w}),showSizeChanger:!0,pageSizeOptions:Jt,itemRender:Kn,showQuickJumper:!0},pe(o)?{}:o),e(t))});function i(o){const w=e(l);t.value=F(F({},pe(w)?{}:w),o)}function d(){return e(l)}function g(){return e(s)}function c(o){return Y(this,null,function*(){s.value=o})}return{getPagination:d,getPaginationInfo:l,setShowPagination:c,getShowPagination:g,setPagination:i}}function Hn(n){return({text:a,record:t,index:s})=>(we(t).onValid=()=>Y(this,null,function*(){if(Ne(t==null?void 0:t.validCbs)){const l=((t==null?void 0:t.validCbs)||[]).map(d=>d());return(yield Promise.all(l)).every(d=>!!d)}else return!1}),we(t).onEdit=(l,i=!1)=>Y(this,null,function*(){var d,g;return i||(t.editable=l),!l&&i?(yield t.onValid())&&(yield(d=t.onSubmitEdit)==null?void 0:d.call(t))?(t.editable=!1,!0):!1:(!l&&!i&&((g=t.onCancelEdit)==null||g.call(t)),!0)}),je(Fn,{value:a,record:t,column:n,index:s}))}function Ct(n,a){const{key:t,dataIndex:s,children:l}=n;n.align=n.align||Zt,a&&(t||(n.key=typeof s=="object"?s.join("-"):s),pe(n.ellipsis)||Object.assign(n,{ellipsis:a})),l&&l.length&&vt(l,!!a)}function vt(n,a){n&&n.forEach(t=>{const{children:s}=t;Ct(t,a),vt(s,a)})}function Nn(n,a,t){const{t:s}=_e(),{showIndexColumn:l,indexColumnProps:i,isTreeTable:d}=e(n);let g=!1;if(e(d)||(t.forEach(()=>{const o=t.findIndex(w=>w.flag===Ae);l?g=o===-1:!l&&o!==-1&&t.splice(o,1)}),!g))return;const c=t.some(o=>o.fixed==="left");t.unshift(F(F({flag:Ae,width:60,title:s("component.table.index"),align:"center",customRender:({index:o})=>{const w=e(a);if(pe(w))return`${o+1}`;const{current:A=1,pageSize:S=qe}=w;return((A<1?1:A)-1)*S+o+1}},c?{fixed:"left"}:{}),i))}function zn(n,a){const{actionColumn:t}=e(n);if(!t)return;const s=a.findIndex(l=>l.flag===ze);s===-1&&a.push(me(F(me(F({},a[s]),{fixed:"right"}),t),{flag:ze}))}function Ln(n,a){const t=N(e(n).columns);let s=e(n).columns;const l=P(()=>{const u=Se(e(t));if(Nn(n,a,u),zn(n,u),!u)return[];const{ellipsis:f}=e(n);return u.forEach(v=>{const{customRender:y,slots:p}=v;Ct(v,Reflect.has(v,"ellipsis")?!!v.ellipsis:!!f&&!y&&!p)}),u});function i(u){const f=u.ifShow;let v=!0;return pe(f)&&(v=f),q(f)&&(v=f(u)),v}const{hasPermission:d}=en(),g=P(()=>{const u=it(e(l)),f=y=>{const{slots:p,customRender:E,format:I,edit:B,editRow:G,flag:te}=y;(!p||!(p!=null&&p.title))&&(y.customTitle=y.title);const ne=[Ae,ze].includes(te);return!E&&I&&!B&&!ne&&(y.customRender=({text:ye,record:h,index:C})=>Mn(ye,I,h,C)),(B||G)&&!ne&&(y.customRender=Hn(y)),rt(y)};return Se(u).filter(y=>d(y.auth)&&i(y)).map(y=>{var p;return(p=y.children)!=null&&p.length&&(y.children=y.children.map(f)),f(y)})});be(()=>e(n).columns,u=>{var f;t.value=u,s=(f=u==null?void 0:u.filter(v=>!v.flag))!=null?f:[]});function c(u,f){!u||!f||s.forEach(v=>{if(v.dataIndex===u){Object.assign(v,f);return}})}function o(u){const f=Se(u);if(!Ne(f))return;if(f.length<=0){t.value=[];return}const v=f[0],y=s.map(p=>p.dataIndex);if(!Le(v)&&!Ne(v))t.value=f;else{const p=f.map(I=>I.toString()),E=[];s.forEach(I=>{var B;E.push(me(F({},I),{defaultHidden:!p.includes(((B=I.dataIndex)==null?void 0:B.toString())||I.key)}))}),pn(y,f)||E.sort((I,B)=>{var G,te;return p.indexOf((G=I.dataIndex)==null?void 0:G.toString())-p.indexOf((te=B.dataIndex)==null?void 0:te.toString())}),t.value=E}}function w(u){const{ignoreIndex:f,ignoreAction:v,sort:y}=u||{};let p=we(e(l));return f&&(p=p.filter(E=>E.flag!==Ae)),v&&(p=p.filter(E=>E.flag!==ze)),y&&(p=it(p)),p}function A(){return s}function S(u){Ne(u)&&(s=u.filter(f=>!f.flag))}function x(u,f){f.width=u}return{getColumnsRef:l,getCacheColumns:A,getColumns:w,setColumns:o,setColumnWidth:x,getViewColumns:g,setCacheColumnsByField:c,setCacheColumns:S}}function it(n){const a=[],t=[],s=[];for(const l of n){if(l.fixed==="left"){a.push(l);continue}if(l.fixed==="right"){t.push(l);continue}s.push(l)}return[...a,...s,...t].filter(l=>!l.defaultHidden)}function Mn(n,a,t,s){if(!a)return n;if(q(a))return a(n,t,s);try{const l="date|";if(Le(a)&&a.startsWith(l)&&n){const i=a.replace(l,"");return i?tn(n,i):n}if(Cn(a))return a.get(n)}catch(l){return n}}function Un(n,{getPaginationInfo:a,setPagination:t,setLoading:s,getFieldsValue:l,clearSelectedRowKeys:i,tableData:d},g){const c=rt({sortInfo:{},filterInfo:{}}),o=N([]),w=N({});Ge(()=>{d.value=e(o)}),be(()=>e(n).dataSource,()=>{const{dataSource:h,api:C}=e(n);!C&&h&&(o.value=h)},{immediate:!0});function A(h,C,D){const{clearSelectOnPageChange:O,sortFn:z,filterFn:L}=e(n);O&&i(),t(h);const M={};if(D&&q(z)){const K=z(D);c.sortInfo=K,M.sortInfo=K}if(C&&q(L)){const K=L(C);c.filterInfo=K,M.filterInfo=K}B(M)}function S(h){!h||!Array.isArray(h)||h.forEach(C=>{C[ue]||(C[ue]=st()),C.children&&C.children.length&&S(C.children)})}const x=P(()=>e(n).autoCreateKey&&!e(n).rowKey),u=P(()=>{const{rowKey:h}=e(n);return e(x)?ue:h}),f=P(()=>{const h=e(o);if(!h||h.length===0)return e(o);if(e(x)){const C=h[0],D=h[h.length-1];if(C&&D&&(!C[ue]||!D[ue])){const O=Se(e(o));O.forEach(z=>{z[ue]||(z[ue]=st()),z.children&&z.children.length&&S(z.children)}),o.value=O}}return e(o)});function v(h,C,D){return Y(this,null,function*(){return o.value[h]&&(o.value[h][C]=D),o.value[h]})}function y(h,C){const D=I(h);if(D){for(const O in D)Reflect.has(C,O)&&(D[O]=C[O]);return D}}function p(h){var z;if(!o.value||o.value.length==0)return;const C=e(u);if(!C)return;const D=Array.isArray(h)?h:[h];function O(L,M){const K=ae(L,M);if(K===null||K.index===-1)return;K.data.splice(K.index,1);function ae(Z,le){var oe;if(Z==null)return null;for(let W=0;W<Z.length;W++){const J=Z[W];let se=C;if(q(C)&&(se=C(J)),J[se]===le)return{index:W,data:Z};if(((oe=J.children)==null?void 0:oe.length)>0){const ge=ae(J.children,le);if(ge!=null)return ge}}return null}}for(const L of D)O(o.value,L),O(e(n).dataSource,L);t({total:(z=e(n).dataSource)==null?void 0:z.length})}function E(h,C){var O;C=C!=null?C:(O=o.value)==null?void 0:O.length;const D=an(h)?[h]:h;return e(o).splice(C,0,...D),e(o)}function I(h){if(!o.value||o.value.length==0)return;const C=e(u);if(!C)return;const{childrenColumnName:D="children"}=e(n);return(z=>{let L;return z.some(function M(K){if(typeof C=="function"){if(C(K)===h)return L=K,!0}else if(Reflect.has(K,C)&&K[C]===h)return L=K,!0;return K[D]&&K[D].some(M)}),L})(o.value)}function B(h){return Y(this,null,function*(){var Z,le,oe;const{api:C,searchInfo:D,defSort:O,fetchSetting:z,beforeFetch:L,afterFetch:M,useSearchForm:K,pagination:ae}=e(n);if(!(!C||!q(C)))try{s(!0);const{pageField:W,sizeField:J,listField:se,totalField:ge}=Object.assign({},Qt,z);let he={};const{current:Ie=1,pageSize:Re=qe}=e(a);pe(ae)&&!ae||pe(a)?he={}:(he[W]=h&&h.page||Ie,he[J]=Re);const{sortInfo:ke={},filterInfo:r}=c;let b=vn(he,K?l():{},D,(Z=h==null?void 0:h.searchInfo)!=null?Z:{},O,ke,r,(le=h==null?void 0:h.sortInfo)!=null?le:{},(oe=h==null?void 0:h.filterInfo)!=null?oe:{});L&&q(L)&&(b=(yield L(b))||b);const _=yield C(b);w.value=_;const m=Array.isArray(_);let k=m?_:lt(_,se);const ce=m?_.length:lt(_,ge);if(Number(ce)){const ie=Math.ceil(ce/Re);if(Ie>ie)return t({current:ie}),yield B(h)}return M&&q(M)&&(k=(yield M(k))||k),o.value=k,t({total:ce||0}),h&&h.page&&t({current:h.page||1}),g("fetch-success",{items:e(k),total:ce}),k}catch(W){g("fetch-error",W),o.value=[],t({total:0})}finally{s(!1)}})}function G(h){o.value=h}function te(){return f.value}function ne(){return w.value}function ye(h){return Y(this,null,function*(){return yield B(h)})}return We(()=>{nn(()=>{e(n).immediate&&B()},16)}),{getDataSourceRef:f,getDataSource:te,getRawDataSource:ne,getRowKey:u,setTableData:G,getAutoCreateKey:x,fetch:B,reload:ye,updateTableData:v,updateTableDataRecord:y,deleteTableDataRecord:p,insertTableDataRecord:E,findTableDataRecord:I,handleTableChange:A}}function Vn(n){const a=N(e(n).loading);be(()=>e(n).loading,l=>{a.value=l});const t=P(()=>e(a));function s(l){a.value=l}return{getLoading:t,setLoading:s}}function jn(n,a,t){const s=N([]),l=N([]),i=P(()=>{const{rowSelection:f}=e(n);return f?F({selectedRowKeys:e(s),onChange:(v,y)=>{var p;c(v),(p=f.onChange)==null||p.call(f,v,y)}},Je(f,["onChange"])):null});be(()=>{var f;return(f=e(n).rowSelection)==null?void 0:f.selectedRowKeys},f=>{c(f)}),be(()=>e(s),()=>{$e(()=>{const{rowSelection:f}=e(n);if(f){const{onChange:v}=f;v&&q(v)&&v(S(),x())}t("selection-change",{keys:S(),rows:x()})})},{deep:!0});const d=P(()=>e(n).autoCreateKey&&!e(n).rowKey),g=P(()=>{const{rowKey:f}=e(n);return e(d)?ue:f});function c(f){var p;s.value=f||[];const v=ln(we(e(a)).concat(we(e(l))),E=>f==null?void 0:f.includes(E[e(g)]),{children:(p=n.value.childrenColumnName)!=null?p:"children"}),y=[];f==null||f.forEach(E=>{const I=v.find(B=>B[e(g)]===E);I&&y.push(I)}),l.value=y}function o(f){const{rowKey:v}=e(n);l.value=f,s.value=l.value.map(y=>{const p=(q(v)?v(y):v)||"key";return y[p]})}function w(){l.value=[],s.value=[]}function A(f){const y=e(s).findIndex(p=>p===f);y!==-1&&e(s).splice(y,1)}function S(){return e(s)}function x(){return e(l)}function u(){return e(i)}return{getRowSelection:u,getRowSelectionRef:i,getSelectRows:x,getSelectRowKeys:S,setSelectedRowKeys:c,clearSelectedRowKeys:w,deleteSelectRowByKey:A,setSelectedRows:o}}function Gn(n,a){let t;function s(i){return Y(this,null,function*(){var c;const{id:d}=i,g=t==null?void 0:t.querySelector(`[data-row-key="${d}"]`);yield $e(),t==null||t.scrollTo({top:(c=g==null?void 0:g.offsetTop)!=null?c:0,behavior:"smooth"})})}function l(i){const d=e(n);if(!d)return;const g=d.$el;if(!g||!t&&(t=g.querySelector(".ant-table-body"),!t))return;const c=e(a);if(c)if(i==="top")s(c[0]);else if(i==="bottom")s(c[c.length-1]);else{const o=c.find(w=>w.id===i);o&&s(o)}}return{scrollTo:l}}function Wn(n,a,t){return!a||t?n[ue]:Le(a)?n[a]:q(a)?n[a(n)]:null}function qn(n,{setSelectedRowKeys:a,getSelectRowKeys:t,getAutoCreateKey:s,clearSelectedRowKeys:l,emit:i}){return{customRow:(g,c)=>({onClick:o=>{o==null||o.stopPropagation();function w(){var p;const{rowSelection:A,rowKey:S,clickToRowSelect:x}=e(n);if(!A||!x)return;const u=t()||[],f=Wn(g,S,e(s));if(f===null)return;if(A.type==="checkbox"){const E=(p=o.composedPath)==null?void 0:p.call(o).find(G=>G.tagName==="TR");if(!E)return;const I=E.querySelector("input[type=checkbox]");if(!I||I.hasAttribute("disabled"))return;if(!u.includes(f)){u.push(f),a(u);return}const B=u.findIndex(G=>G===f);u.splice(B,1),a(u);return}if(A.type==="radio"){if(!u.includes(f)){u.length&&l(),a([f]);return}l()}}w(),i("row-click",g,c,o)},onDblclick:o=>{i("row-dbClick",g,c,o)},onContextmenu:o=>{i("row-contextmenu",g,c,o)},onMouseenter:o=>{i("row-mouseenter",g,c,o)},onMouseleave:o=>{i("row-mouseleave",g,c,o)}})}}function Jn(n,a){function t(s,l){const{striped:i,rowClassName:d}=e(n),g=[];return i&&g.push((l||0)%2===1?`${a}-row__striped`:""),d&&q(d)&&g.push(d(s,l)),g.filter(c=>!!c).join(" ")}return{getRowClassName:t}}const Zn=["data-no"],Qn=ee({name:"ColumnSetting",__name:"ColumnSetting",props:{cache:{type:Boolean,default:()=>!1}},emits:["columns-change"],setup(n,{emit:a}){const t=n,s=pt(),l=Vt(),{t:i}=_e(),{prefixCls:d}=xe("basic-column-setting"),g=ut(),c=Oe(),o=()=>q(g.getPopupContainer)?g.getPopupContainer():ht();let w=!1,A=!1;const S=N([]),x=N(null),u=N([]);be(u,()=>{w&&(S.value.filter(r=>u.value.includes(r.value)).forEach(r=>{r.column.defaultHidden=!1}),S.value.filter(r=>!u.value.includes(r.value)).forEach(r=>{r.column.defaultHidden=!0,r.fixed=void 0}),ae(),O(),t.cache&&G())});const f=N(!1),v=()=>{u.value.length<S.value.length?u.value=S.value.map(r=>r.value):u.value=[]},y=P(()=>u.value.length>0&&u.value.length<S.value.length),p=N(!1),E=r=>{Z(r.target.checked),t.cache&&typeof l.name=="string"&&s.setShowIndexColumn(l.name,r.target.checked)},I=N(!1),B=r=>{le(r.target.checked),t.cache&&typeof l.name=="string"&&s.setShowRowSelection(l.name,r.target.checked)},G=()=>{typeof l.name=="string"&&s.setColumns(l.name,S.value)},te=()=>{p.value=W,E({target:{checked:W}}),I.value=J,B({target:{checked:J}}),S.value=Se(ge),oe()},ne=(r,b)=>{b==="left"?!r.fixed||r.fixed==="right"?r.fixed="left":r.fixed=void 0:b==="right"&&(!r.fixed||r.fixed==="left"?r.fixed="right":r.fixed=void 0),O(),t.cache&&G()},ye=()=>Y(this,null,function*(){if(x.value){const r=x.value.$el;Array.from(r.children).forEach(b=>r.removeChild(b))}yield $e()}),h=r=>{if(r){if("ifShow"in r){if(typeof r.ifShow=="boolean")return r.ifShow;if(r.ifShow)return r.ifShow(r)}return!0}return!1},C=()=>c.getColumns({ignoreIndex:!0,ignoreAction:!0}).filter(r=>h(r)),D=r=>{A=!0,c==null||c.setColumns(r);const b=r.map(_=>({dataIndex:_.dataIndex?_.dataIndex.toString():"",fixed:_.fixed,visible:!_.defaultHidden}));a("columns-change",b)},O=()=>{var m;const r=Se(c.getColumns());let b=r.filter(k=>k.flag!==Ae&&(k.fixed==="left"||k.fixed===!0)).length;p.value&&b++;for(const k of S.value){const ce=r.findIndex(ie=>ie.dataIndex===k.value);if(ce>-1){const ie=r[ce];ie.defaultHidden=(m=k.column)==null?void 0:m.defaultHidden,ie.fixed=k.fixed,r.splice(ce,1),r.splice(b++,0,ie)}}const _=r.findIndex(k=>k.dataIndex==="action");if(_>-1){const k=r.splice(_,1);r.push(k[0])}D(r)},z=()=>Y(this,null,function*(){if(yield $e(),x.value){const r=x.value.$el;An.create(e(r),{animation:500,delay:400,delayOnTouchOnly:!0,handle:".table-column-drag-icon ",dataIdAttr:"data-no",onEnd:b=>{const{oldIndex:_,newIndex:m}=b;if(ot(_)||ot(m)||_===m)return;const k=Se(S.value);_>m?(k.splice(m,0,k[_]),k.splice(_+1,1)):(k.splice(m+1,0,k[_]),k.splice(_,1)),S.value=k,O(),t.cache&&G()}})}}),L=()=>{if(typeof l.name=="string"){let r=s.getColumns(l.name);if(r&&JSON.stringify(S.value.map(b=>({value:b.value,label:b.label})))!==JSON.stringify(r.map(b=>({value:b.value,label:b.label})))){const b=S.value.reduce((_,m)=>(_[m.value]=m.label,_),{});if(Array.isArray(r)){r=r.filter(m=>b[m.value]),r.forEach(m=>{m.label=b[m.value]});const _=r.map(m=>m.value);r=r.concat(S.value.filter(m=>!_.includes(m.value))),s.setColumns(l.name,r)}}}},M=()=>{if(typeof l.name=="string"){const r=s.getShowIndexColumn(l.name);typeof r=="boolean"&&(p.value=W&&r);const b=s.getShowRowSelection(l.name);typeof b=="boolean"&&(I.value=J&&b)}if(E({target:{checked:p.value}}),B({target:{checked:I.value}}),typeof l.name=="string"){const r=s.getColumns(l.name);Array.isArray(r)&&(S.value=r)}},K=()=>{u.value=S.value.filter(r=>{var b;return!((b=r.column)!=null&&b.defaultHidden)}).map(r=>r.value)},ae=()=>{f.value=S.value.length===u.value.length},Z=r=>{A=!0,c.setProps({showIndexColumn:r})},le=r=>{A=!0,c.setProps({rowSelection:r?me(F({},Je(se,["selectedRowKeys"])),{fixed:!0}):void 0})},oe=()=>{K(),ae(),Z(p.value),le(I.value),O()};let W=!1,J=!1,se,ge=[];const he=()=>Y(this,null,function*(){var r;if(!w){const b=C();(r=c.setCacheColumns)==null||r.call(c,b);const _=[];for(const m of b)_.push({label:typeof m.title=="string"?m.title:m.customTitle==="string"?m.customTitle:"",value:typeof m.dataIndex=="string"?m.dataIndex:m.title==="string"?m.title:"",column:{defaultHidden:m.defaultHidden},fixed:m.fixed});W=c.getBindValues.value.showIndexColumn||!1,se=c.getRowSelection(),J=!!se,ge=_,p.value=W,I.value=J,S.value=Se(_),t.cache&&L(),t.cache&&M(),oe(),w=!0}});(()=>Y(this,null,function*(){yield ye(),he()}))();const Re=P(()=>c==null?void 0:c.getColumns()),ke=P(()=>c==null?void 0:c.getBindValues);return We(()=>{be([Re,ke],()=>{A?A=!1:(w=!1,he())})}),(r,b)=>{const _=ft("a-button");return $(),j(e(Te),{placement:"top"},{title:R(()=>[fe("span",null,U(e(i)("component.table.settingColumn")),1)]),default:R(()=>[T(e(Sn),{placement:"bottomLeft",trigger:"click",onOpenChange:z,overlayClassName:`${e(d)}__column-list`,getPopupContainer:o},{title:R(()=>[fe("div",{class:ve(`${e(d)}__popover-title`)},[T(e(De),{indeterminate:y.value,checked:f.value,"onUpdate:checked":b[0]||(b[0]=m=>f.value=m),onChange:v},{default:R(()=>[re(U(e(i)("component.table.settingColumnShow")),1)]),_:1},8,["indeterminate","checked"]),T(e(De),{checked:p.value,"onUpdate:checked":b[1]||(b[1]=m=>p.value=m),onChange:E},{default:R(()=>[re(U(e(i)("component.table.settingIndexColumnShow")),1)]),_:1},8,["checked"]),e(J)?($(),j(e(De),{key:0,checked:I.value,"onUpdate:checked":b[2]||(b[2]=m=>I.value=m),onChange:B},{default:R(()=>[re(U(e(i)("component.table.settingSelectColumnShow")),1)]),_:1},8,["checked"])):X("",!0),T(_,{size:"small",type:"link",onClick:te},{default:R(()=>[re(U(e(i)("common.resetText")),1)]),_:1})],2)]),content:R(()=>[T(e(on),null,{default:R(()=>[T(e(De).Group,{value:u.value,"onUpdate:value":b[3]||(b[3]=m=>u.value=m),ref_key:"columnOptionsRef",ref:x},{default:R(()=>[($(!0),de(jt,null,Ve(S.value,m=>($(),de("div",{key:m.value,class:ve(`${e(d)}__check-item`),"data-no":m.value},[T(e(bn),{class:"table-column-drag-icon"}),T(e(De),{value:m.value},{default:R(()=>[re(U(m.label),1)]),_:2},1032,["value"]),T(e(Te),{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:o},{title:R(()=>[re(U(e(i)("component.table.settingFixedLeft")),1)]),default:R(()=>[T(at,{icon:"line-md:arrow-align-left",class:ve([`${e(d)}__fixed-left`,{active:m.fixed==="left",disabled:m.value?!u.value.includes(m.value):!0}]),onClick:k=>ne(m,"left")},null,8,["class","onClick"])]),_:2},1024),T(e(mt),{type:"vertical"}),T(e(Te),{placement:"bottomLeft",mouseLeaveDelay:.4,getPopupContainer:o},{title:R(()=>[re(U(e(i)("component.table.settingFixedRight")),1)]),default:R(()=>[T(at,{icon:"line-md:arrow-align-left",class:ve([`${e(d)}__fixed-right`,{active:m.fixed==="right",disabled:m.value?!u.value.includes(m.value):!0}]),onClick:k=>ne(m,"right")},null,8,["class","onClick"])]),_:2},1024)],10,Zn))),128))]),_:1},8,["value"])]),_:1})]),default:R(()=>[T(e(wn))]),_:1},8,["overlayClassName"])]),_:1})}}}),Xn=ee({name:"SizeSetting",__name:"SizeSetting",setup(n){const a=pt(),t=Oe(),{t:s}=_e(),l=N([t.getSize()]),i=({key:d})=>{l.value=[d],a.setTableSize(d),t.setProps({size:d})};return We(()=>{l.value=[a.getTableSize],t.setProps({size:l.value[0]})}),(d,g)=>($(),j(e(Te),{placement:"top"},{title:R(()=>[fe("span",null,U(e(s)("component.table.settingDens")),1)]),default:R(()=>[T(e(yn),{placement:"bottom",trigger:["click"],getPopupContainer:e(ht)},{overlay:R(()=>[T(e(He),{onClick:i,selectable:"",selectedKeys:l.value,"onUpdate:selectedKeys":g[0]||(g[0]=c=>l.value=c)},{default:R(()=>[T(e(He).Item,{key:"default"},{default:R(()=>[fe("span",null,U(e(s)("component.table.settingDensDefault")),1)]),_:1}),T(e(He).Item,{key:"middle"},{default:R(()=>[fe("span",null,U(e(s)("component.table.settingDensMiddle")),1)]),_:1}),T(e(He).Item,{key:"small"},{default:R(()=>[fe("span",null,U(e(s)("component.table.settingDensSmall")),1)]),_:1})]),_:1},8,["selectedKeys"])]),default:R(()=>[T(e(_n))]),_:1},8,["getPopupContainer"])]),_:1}))}}),Yn=ee({name:"RedoSetting",__name:"RedoSetting",setup(n){const a=Oe(),{t}=_e();function s(){a.reload()}return(l,i)=>($(),j(e(Te),{placement:"top"},{title:R(()=>[fe("span",null,U(e(t)("common.redo")),1)]),default:R(()=>[T(e(Rn),{onClick:s})]),_:1}))}}),ea=ee({name:"FullScreenSetting",__name:"FullScreenSetting",setup(n){const a=Oe(),{t}=_e(),{toggle:s,isFullscreen:l}=sn(a.wrapRef);return(i,d)=>($(),j(e(Te),{placement:"top"},{title:R(()=>[fe("span",null,U(e(t)("component.table.settingFullScreen")),1)]),default:R(()=>[e(l)?($(),j(e(xn),{key:1,onClick:e(s)},null,8,["onClick"])):($(),j(e(Tn),{key:0,onClick:e(s)},null,8,["onClick"]))]),_:1}))}}),ta={class:"table-settings"},na=ee({name:"TableSetting",__name:"index",props:{setting:{type:Object,default:()=>({})}},emits:["columns-change"],setup(n,{emit:a}){const t=n,s=Oe(),l=P(()=>F({redo:!0,size:!0,setting:!0,settingCache:!1,fullScreen:!1},t.setting));function i(g){a("columns-change",g)}function d(){return s?e(s.wrapRef):document.body}return(g,c)=>($(),de("div",ta,[l.value.redo?($(),j(Yn,{key:0,getPopupContainer:d})):X("",!0),l.value.size?($(),j(Xn,{key:1,getPopupContainer:d})):X("",!0),l.value.setting?($(),j(Qn,{key:2,onColumnsChange:i,getPopupContainer:d,cache:l.value.settingCache},null,8,["cache"])):X("",!0),l.value.fullScreen?($(),j(ea,{key:3,getPopupContainer:d})):X("",!0)]))}}),aa=ee({name:"BasicTableTitle",__name:"TableTitle",props:{title:{type:[Function,String]},getSelectRows:{type:Function},helpMessage:{type:[String,Array]}},setup(n){const a=n,{prefixCls:t}=xe("basic-table-title"),s=P(()=>{const{title:l,getSelectRows:i=()=>{}}=a;let d=l;return q(l)&&(d=l({selectRows:i()})),d});return(l,i)=>s.value?($(),j(e(cn),{key:0,class:ve(e(t)),helpMessage:n.helpMessage},{default:R(()=>[re(U(s.value),1)]),_:1},8,["class","helpMessage"])):X("",!0)}}),la={key:0},oa={key:1},sa=ee({name:"TableSelectBar",__name:"TableSelectionBar",props:{count:{default:()=>0},clearSelectedRowKeys:{}},setup(n){const a=n,{t}=_e(),{prefixCls:s}=xe("table-select-bar");return(l,i)=>{const d=ft("a-button");return $(),j(e(In),{type:"info",showIcon:"",class:ve([e(s)])},{message:R(()=>[a.count>0?($(),de("span",la,U(e(t)("component.table.selectionBarTips",{count:a.count})),1)):($(),de("span",oa,U(e(t)("component.table.selectionBarEmpty")),1)),dt(T(d,{type:"link",onClick:l.clearSelectedRowKeys,size:"small"},{default:R(()=>[re(U(e(t)("component.table.selectionBarClear")),1)]),_:1},8,["onClick"]),[[gt,a.count>0]])]),_:1},8,["class"])}}}),ca=rn(sa,[["__scopeId","data-v-80ee960a"]]),ia={style:{width:"100%"}},ra={key:0,style:{margin:"5px"}},ua={key:1,style:{margin:"5px"}},fa={class:"flex items-center"},da=ee({name:"BasicTableHeader",__name:"TableHeader",props:{title:{type:[Function,String]},tableSetting:{type:Object},showTableSetting:{type:Boolean},titleHelpMessage:{type:[String,Array],default:""},clearSelectedRowKeys:{type:Function},count:{type:Number,default:0},showSelectionBar:{type:Boolean,default:!1}},emits:["columns-change"],setup(n,{emit:a}){const t=n,{prefixCls:s}=xe("basic-table-header");function l(i){a("columns-change",i)}return(i,d)=>($(),de("div",ia,[i.$slots.headerTop?($(),de("div",ra,[Ce(i.$slots,"headerTop")])):X("",!0),n.showSelectionBar?($(),de("div",ua,[T(ca,{clearSelectedRowKeys:t.clearSelectedRowKeys,count:t.count},null,8,["clearSelectedRowKeys","count"])])):X("",!0),fe("div",fa,[i.$slots.tableTitle?Ce(i.$slots,"tableTitle",{key:0}):X("",!0),!i.$slots.tableTitle&&n.title?($(),j(aa,{key:1,helpMessage:n.titleHelpMessage,title:n.title},null,8,["helpMessage","title"])):X("",!0),fe("div",{class:ve(`${e(s)}__toolbar`)},[Ce(i.$slots,"toolbar"),i.$slots.toolbar&&n.showTableSetting?($(),j(e(mt),{key:0,type:"vertical"})):X("",!0),n.showTableSetting?($(),j(na,{key:1,setting:n.tableSetting,onColumnsChange:l},null,8,["setting"])):X("",!0)],2)])]))}});function ga(n,a,t,s){return{getHeaderProps:P(()=>{const{title:i,showTableSetting:d,titleHelpMessage:g,tableSetting:c,showSelectionBar:o}=e(n),w=!a.tableTitle&&!i&&!a.toolbar&&!d;return w&&!Le(i)?{}:{title:w?null:()=>je(da,{title:i,titleHelpMessage:g,showTableSetting:d,tableSetting:c,onColumnsChange:t.onColumnsChange,clearSelectedRowKeys:s.clearSelectedRowKeys,count:s.getSelectRowKeys().length,showSelectionBar:o},F(F(F({},a.toolbar?{toolbar:()=>Ue(a,"toolbar")}:{}),a.tableTitle?{tableTitle:()=>Ue(a,"tableTitle")}:{}),a.headerTop?{headerTop:()=>Ue(a,"headerTop")}:{}))}})}}function ha(n,a,t){const s=N([]),l=P(()=>e(n).autoCreateKey&&!e(n).rowKey),i=P(()=>{const{rowKey:S}=e(n);return e(l)?ue:S}),d=P(()=>{const{isTreeTable:S}=e(n);return S?{expandedRowKeys:e(s),onExpandedRowsChange:x=>{s.value=x,t("expanded-rows-change",x)}}:{}});function g(){const S=A();s.value=S}function c(){s.value=[]}function o(S){const{isTreeTable:x}=e(n);x&&(s.value=[...s.value,...S])}function w(S){const{isTreeTable:x}=e(n);x&&(s.value=e(s).filter(u=>!S.includes(u)))}function A(S){const x=[],{childrenColumnName:u}=e(n);return we(S||e(a)).forEach(f=>{x.push(f[e(i)]);const v=f[u||"children"];v!=null&&v.length&&x.push(...A(v))}),x}return{getExpandOption:d,expandAll:g,collapseAll:c,expandRows:o,collapseRows:w}}function ma(n,a,t,s){const l=P(()=>(e(s)||[]).length===0),i=P(()=>{const{summaryFunc:g,showSummary:c,summaryData:o}=e(n);return c&&!e(l)?()=>je(Pn,{summaryFunc:g,summaryData:o,scroll:e(a)}):void 0});Ge(()=>{d()});function d(){const{showSummary:g}=e(n);!g||e(l)||$e(()=>{const c=e(t);if(!c)return;const o=c.$el.querySelector(" .ant-table-content,  .ant-table-body");un({el:o,name:"scroll",listener:()=>{const w=c.$el.querySelector('.ant-table-footer .ant-table-container  [class^="ant-table-"]');!w||!o||(w.scrollLeft=o.scrollLeft)},wait:0,options:!0})})}return{getFooterProps:i}}function pa(n,a,t,s){const l=P(()=>{const{formConfig:c}=e(n),{submitButtonOptions:o}=c||{};return me(F({showAdvancedButton:!0},c),{submitButtonOptions:F({loading:e(s)},o),compact:!0})}),i=P(()=>Object.keys(a).map(o=>o.startsWith("form-")?o:null).filter(o=>!!o));function d(c){var o,w;return c&&(w=(o=c==null?void 0:c.replace)==null?void 0:o.call(c,/form-/,""))!=null?w:""}function g(c){const{handleSearchInfoFn:o}=e(n);o&&q(o)&&(c=o(c)||c),t({searchInfo:c,page:1})}return{getFormProps:l,replaceFormSlotKey:d,getFormSlotKeys:i,handleSearchInfoChange:g}}const Ia=ee({name:"BasicTable",__name:"BasicTable",props:Dn,emits:["fetch-success","fetch-error","selection-change","register","row-click","row-dbClick","row-contextmenu","row-mouseenter","row-mouseleave","edit-end","edit-cancel","edit-row-end","edit-change","expanded-rows-change","change","columns-change"],setup(n,{expose:a,emit:t}){const s=n,l=ut(),i=Gt(),d=N(null),g=N([]),c=N(null),o=N(null),w=N(),{prefixCls:A}=xe("basic-table"),[S,x]=Yt(),u=P(()=>F(F({},s),e(w))),f=Wt(fn,!1);Ge(()=>{e(f)&&s.canResize&&dn()});const{getLoading:v,setLoading:y}=Vn(u),{getPaginationInfo:p,getPagination:E,setPagination:I,setShowPagination:B,getShowPagination:G}=Bn(u),{getRowSelection:te,getRowSelectionRef:ne,getSelectRows:ye,setSelectedRows:h,clearSelectedRowKeys:C,getSelectRowKeys:D,deleteSelectRowByKey:O,setSelectedRowKeys:z}=jn(u,g,t),{handleTableChange:L,getDataSourceRef:M,getDataSource:K,getRawDataSource:ae,setTableData:Z,updateTableDataRecord:le,deleteTableDataRecord:oe,insertTableDataRecord:W,findTableDataRecord:J,fetch:se,getRowKey:ge,reload:he,getAutoCreateKey:Ie,updateTableData:Re}=Un(u,{tableData:g,getPaginationInfo:p,setLoading:y,setPagination:I,getFieldsValue:x.getFieldsValue,clearSelectedRowKeys:C},t);function ke(H,Q,V,Pe){L(H,Q,V),t("change",H,Q,V);const{onChange:Me}=e(u);Me&&q(Me)&&Me(H,Q,V,Pe)}const{getViewColumns:r,getColumns:b,setCacheColumnsByField:_,setCacheColumns:m,setColumnWidth:k,setColumns:ce,getColumnsRef:ie,getCacheColumns:St}=Ln(u,p),{getScrollRef:Ze,redoHeight:Qe}=$n(u,d,ie,ne,M,c,o),{scrollTo:bt}=Gn(d,M),{customRow:wt}=qn(u,{setSelectedRowKeys:z,getSelectRowKeys:D,clearSelectedRowKeys:C,getAutoCreateKey:Ie,emit:t}),{getRowClassName:yt}=Jn(u,A),{getExpandOption:_t,expandAll:Rt,expandRows:Tt,collapseRows:xt,collapseAll:It}=ha(u,g,t),kt={onColumnsChange:H=>{var Q,V;t("columns-change",H),(V=(Q=e(u)).onColumnsChange)==null||V.call(Q,H)}},Ft={clearSelectedRowKeys:C,getSelectRowKeys:D},{getHeaderProps:Pt}=ga(u,i,kt,Ft),{getFooterProps:Dt}=ma(u,Ze,d,M),{getFormProps:$t,replaceFormSlotKey:At,getFormSlotKeys:Ot,handleSearchInfoChange:Et}=pa(u,i,se,v),Fe=P(()=>{const H=e(M);let Q=F(me(F(F(me(F({},l),{customRow:wt}),e(u)),e(Pt)),{scroll:e(Ze),loading:e(v),tableLayout:"fixed",rowSelection:e(ne),rowKey:e(ge),columns:we(e(r)),pagination:we(e(p)),dataSource:H,footer:e(Dt)}),e(_t));return Q=Je(Q,["class","onChange"]),Q}),Kt=P(()=>{const H=e(Fe);return[A,l.class,{[`${A}-form-container`]:H.useSearchForm,[`${A}--inset`]:H.inset}]}),Bt=P(()=>{const{emptyDataIsShowTable:H,useSearchForm:Q}=e(u);return H||!Q?!0:!!e(M).length});function Ht(H){w.value=F(F({},e(w)),H)}const Ee={reload:he,getSelectRows:ye,setSelectedRows:h,clearSelectedRowKeys:C,getSelectRowKeys:D,deleteSelectRowByKey:O,setPagination:I,setTableData:Z,updateTableDataRecord:le,deleteTableDataRecord:oe,insertTableDataRecord:W,findTableDataRecord:J,redoHeight:Qe,setSelectedRowKeys:z,setColumns:ce,setLoading:y,getDataSource:K,getRawDataSource:ae,setProps:Ht,getRowSelection:te,getPaginationRef:E,getColumns:b,getCacheColumns:St,emit:t,updateTableData:Re,setShowPagination:B,getShowPagination:G,setCacheColumnsByField:_,expandAll:Rt,collapseAll:It,expandRows:Tt,collapseRows:xt,scrollTo:bt,getSize:()=>e(Fe).size,setCacheColumns:m};return Xt(me(F({},Ee),{wrapRef:c,getBindValues:Fe})),t("register",Ee,x),a(F({tableElRef:d},Ee)),(H,Q)=>($(),de("div",{ref_key:"wrapRef",ref:c,class:ve(Kt.value)},[Fe.value.useSearchForm?($(),j(e(qt),tt({key:0,ref_key:"formRef",ref:o,submitOnReset:""},e($t),{tableAction:Ee,onRegister:e(S),onSubmit:e(Et),onAdvancedChange:e(Qe)}),et({_:2},[Ve(e(Ot),V=>({name:e(At)(V),fn:R(Pe=>[Ce(H.$slots,V,Ke(Be(Pe||{})))])}))]),1040,["onRegister","onSubmit","onAdvancedChange"])):X("",!0),dt(T(e(kn),tt({ref_key:"tableElRef",ref:d},Fe.value,{rowClassName:e(yt),onChange:ke,onResizeColumn:e(k)}),et({headerCell:R(({column:V})=>[Ce(H.$slots,"headerCell",Ke(Be({column:V})),()=>[T(En,{column:V},null,8,["column"])])]),bodyCell:R(V=>[Ce(H.$slots,"bodyCell",Ke(Be(V||{})))]),_:2},[Ve(Object.keys(H.$slots),V=>({name:V,fn:R(Pe=>[Ce(H.$slots,V,Ke(Be(Pe||{})))])}))]),1040,["rowClassName","onResizeColumn"]),[[gt,Bt.value]])],2))}});export{Ia as _,En as a};
