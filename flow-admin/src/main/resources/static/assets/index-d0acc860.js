var b=(s,i,o)=>new Promise((c,n)=>{var u=a=>{try{l(o.next(a))}catch(r){n(r)}},m=a=>{try{l(o.throw(a))}catch(r){n(r)}},l=a=>a.done?c(a.value):Promise.resolve(a.value).then(u,m);l((o=o.apply(s,i)).next())});import{B as $,a as M}from"./index-6bb63bf0.js";import{_ as N}from"./BasicTable.vue_vue_type_script_setup_true_lang-68f7da80.js";import"./TableImg.vue_vue_type_style_index_0_lang-c025c7d6.js";import{a as W}from"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as O}from"./useTable-dd83d9cb.js";import{g as L}from"./personal-9cdd6bd5.js";import{P as E}from"./index-5a8cda67.js";import F from"./OrgTree-95f059e8.js";import{m as V,d as z,f as T,c as A,a6 as p,Z as g,a7 as C,a8 as h,$ as K,_ as D,F as Q,a9 as Z,E as j,a0 as q,l as w,ab as G}from"./vue-f7f38239.js";import{Q as k}from"./antd-bebda08e.js";import{c as H}from"./index.js";import"./useWindowSizeFn-01ffbee2.js";import"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./useForm-d2875f1c.js";import"./uuid-31b8b5a4.js";import"./sortable.esm-4ae27e0b.js";import"./onMountedOrActivated-a837e8fb.js";import"./index-1b9aa1da.js";import"./useSortable-9ec2a7be.js";import"./download-2647fd8d.js";import"./base64Conver-39fc0d26.js";import"./index-b34be3ab.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-af62677b.js";import"./copyTextToClipboard-ad844e61.js";import"./index-091b1c05.js";import"./useContentViewHeight-4f74c208.js";import"./index-f9546e03.js";import"./useContextMenu-b66322cd.js";import"./dept-92794b55.js";const J=[{title:"姓名",dataIndex:"name",width:80,align:"left"},{title:"工号",dataIndex:"code",width:80,align:"left"},{title:"性别",dataIndex:"sex",width:50,customRender:({record:s})=>{const o=~~s.sex===1,c=o?"green":"red",n=o?"男":"女";return V(k,{color:c},()=>n)}},{title:"公司",dataIndex:"companyName",width:120,align:"left"},{title:"部门",dataIndex:"deptName",width:120,align:"left"}],y=[{field:"keyword",label:"关键字",component:"Input",labelWidth:60,colProps:{span:12,lg:{span:12,offset:0},sm:{span:10,offset:0},xs:{span:16,offset:0}},componentProps:{}}],U=z({props:{title:{type:String,default:"人员选择"}},name:"PersonalSelector",components:{BasicModal:$,BasicTable:N,PageWrapper:E,OrgTree:F,TableAction:W,Tag:k},setup(s,{emit:i}){const o=T([]),c=T(!1),[n,{setModalProps:u,closeModal:m}]=M(e=>b(this,null,function*(){const{selectorProps:t}=e;o.value=t.selectedList,c.value=t.multiSelect,d(o.value.map(R=>R.code)),r({rowSelection:{type:t.multiSelect?"checkbox":"radio",columnWidth:30}}),u({wrapClassName:"selector-content"}),a()}));y.forEach(e=>{e&&(e.componentProps.onkeypress=t=>{t.keyCode===13&&a()})});const[l,{reload:a,setProps:r,getSelectRows:f,setSelectedRowKeys:d}]=O({title:"",api:L,columns:J,immediate:!1,rowSelection:{type:"checkbox",columnWidth:30},formConfig:{labelWidth:60,schemas:y,showResetButton:!1,showAdvancedButton:!1,autoSubmitOnEnter:!0},clickToRowSelect:!0,rowKey:"code",size:"small",canResize:!1,useSearchForm:!0,showTableSetting:!1,showIndexColumn:!1,bordered:!0,scroll:{y:280}}),S=A(()=>"选择人员");function v(){a()}function P(e){o.value.splice(o.value.findIndex(t=>t.code===e),1),d(o.value.map(t=>t.code))}function _({rows:e}){o.value=e.map(t=>({id:t.id,code:t.code,name:t.name}))}function I(){_({rows:f()})}function x(){const e=f();i("success",e),m()}function B(e){let t={};e&&e.sourceType==="1"?t={companyId:e.id}:e&&e.sourceType==="2"&&(t={deptId:e.id}),a({searchInfo:t})}return{registerTable:l,registerModal:n,getTitle:S,selectedList:o,removeSelectedItem:P,rowClick:I,selectionChanged:_,handleSubmit:x,handleSuccess:v,handleSelect:B}}});const X={class:"selected-items"};function Y(s,i,o,c,n,u){const m=p("Tag"),l=p("OrgTree"),a=p("BasicTable"),r=p("PageWrapper"),f=p("BasicModal");return g(),C(f,G({wrapClassName:"selector-body "},s.$attrs,{onRegister:s.registerModal,title:s.getTitle,onOk:s.handleSubmit}),{default:h(()=>[K("div",X,[(g(!0),D(Q,null,Z(s.selectedList,d=>(g(),C(m,{color:"processing",closable:"",onClose:S=>s.removeSelectedItem(d.code)},{default:h(()=>[j(q(d.name),1)]),_:2},1032,["onClose"]))),256))]),w(r,{dense:"",contentClass:"flex"},{default:h(()=>[w(l,{class:"w-1/4 xl:w-3/10",onSelect:s.handleSelect},null,8,["onSelect"]),w(a,{onRegister:s.registerTable,onSelectionChange:s.selectionChanged,onRowClick:s.rowClick,class:"w-3/4 xl:w-7/10"},null,8,["onRegister","onSelectionChange","onRowClick"])]),_:1})]),_:1},16,["onRegister","title","onOk"])}const Re=H(U,[["render",Y]]);export{Re as default};
