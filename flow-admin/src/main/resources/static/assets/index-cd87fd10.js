import{_ as O}from"./BasicTable.vue_vue_type_script_setup_true_lang-68f7da80.js";import"./TableImg.vue_vue_type_style_index_0_lang-c025c7d6.js";import{a as V}from"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as D}from"./useTable-dd83d9cb.js";import{c as E,d as N,p as W,e as U}from"./modelInfo-bc19c532.js";import{P as H}from"./index-5a8cda67.js";import K from"./FlowCategoryTree-85793be5.js";import{b as T}from"./index-6bb63bf0.js";import{_ as q,c as G,s as L}from"./ModelInfoModal.vue_vue_type_style_index_0_lang-6ad62b1d.js";import Q from"./index-48f137e9.js";import{a as Z}from"./app-72ac4173.js";import{aN as j,a as z,c as J}from"./index.js";import{A as X}from"./index-17e4a920.js";import{a1 as Y,aT as ee,P as oe,Q as te,b1 as ne}from"./antd-bebda08e.js";import{d as ae,f as m,x as le,u as k,a6 as a,q as se,n as ie,Z as I,a7 as F,a8 as u,l as r,E as re,aa as ce}from"./vue-f7f38239.js";import"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./useForm-d2875f1c.js";import"./uuid-31b8b5a4.js";import"./sortable.esm-4ae27e0b.js";import"./onMountedOrActivated-a837e8fb.js";import"./useWindowSizeFn-01ffbee2.js";import"./index-1b9aa1da.js";import"./useSortable-9ec2a7be.js";import"./download-2647fd8d.js";import"./base64Conver-39fc0d26.js";import"./index-b34be3ab.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-af62677b.js";import"./copyTextToClipboard-ad844e61.js";import"./index-091b1c05.js";import"./useContentViewHeight-4f74c208.js";import"./index-f9546e03.js";import"./useContextMenu-b66322cd.js";import"./category-90acc8cc.js";import"./index-53e38637.js";import"./index.esm-46106237.js";const{createMessage:x}=z(),de=ae({name:"Bpmn",components:{BasicTable:O,PageWrapper:H,FlowCategoryTree:K,ModelInfoModal:q,TableAction:V,Avatar:Y,Badge:ee,Popconfirm:oe,Tag:te,DeleteOutlined:ne,Authority:X,BpmnPreviewModal:Q},setup(){j();const[o,{openModal:f,setModalProps:g}]=T(),[w,{openModal:v,setModalProps:B}]=T();m({});const l=m({}),s=m(null),n=m(!1),[h,{getForm:b,reload:i}]=D({title:"列表",api:E,columns:G,formConfig:{labelWidth:120,schemas:L,showAdvancedButton:!1,showResetButton:!1,autoSubmitOnEnter:!0},searchInfo:{modelType:0},useSearchForm:!0,showIndexColumn:!1,bordered:!0,actionColumn:{width:210,align:"left",title:"操作",dataIndex:"action"}});le(()=>{const{updateSchema:e}=b();Z().then(t=>{e([{field:"appSn",componentProps:{options:t,labelField:"id"}}])})});function C(){if(!k(l).code){x.warning("请选择分类！",2);return}f(!0,{record:{categoryCode:k(l).code},isUpdate:!1}),g({title:"添加表单",bodyStyle:{padding:"0px",margin:"0px"},defaultFullscreen:!0,maskClosable:!1,keyboard:!1,centered:!0,showOkBtn:!1,showCancelBtn:!1,draggable:!1,canFullscreen:!1,closable:!1,destroyOnClose:!0})}function y(e,t){const{status:_}=e;return[{icon:"ant-design:eye",tooltip:"流程图预览",label:"",onClick:c.bind(null,e)},{icon:"ant-design:play-circle-filled",tooltip:"发布",label:"",popConfirm:{title:"确认发布吗?",confirm:S.bind(null,e),placement:"left"},ifShow:_===2},{icon:"ant-design:stop-twotone",tooltip:"停用",label:"",popConfirm:{title:"确认停用吗?",confirm:P.bind(null,e),placement:"left"},ifShow:_===3||_===2},{icon:"clarity:note-edit-line",tooltip:"修改",label:"",onClick:d.bind(null,e)},{icon:"ant-design:delete-outlined",color:"error",tooltip:"删除",label:"",popConfirm:{title:"是否确认删除",confirm:M.bind(null,e),placement:"left"}}]}function c(e){v(!0,{modelKey:e.modelKey,isUpdate:!0}),B({title:`预览-${e.name}`,bodyStyle:{padding:"0px",margin:"0px"},width:900,height:400,showOkBtn:!1,showCancelBtn:!0,cancelText:"关闭"})}function d(e){f(!0,{record:e,isUpdate:!0}),g({title:"修改表单",bodyStyle:{padding:"0px",margin:"0px"},defaultFullscreen:!0,maskClosable:!1,keyboard:!1,centered:!0,showOkBtn:!1,showCancelBtn:!1,draggable:!1,canFullscreen:!1,closable:!1,destroyOnClose:!0})}function M(e){N([e.id]).then(t=>{p()})}function S(e){n.value=!0,W(e.modelId).then(t=>{p(),x.success("发布成功！",2)}).finally(()=>{n.value=!1})}function P(e){n.value=!0,U(e.modelId).then(t=>{p()}).finally(()=>{n.value=!1})}function p(){let e={categoryCode:s.value};i({searchInfo:e})}function A(){}function R(e){l.value=e,s.value=e.code;let t={categoryCode:e?e.code:""};i({searchInfo:t})}function $(e){if(!e)try{let t={categoryCode:s.value||""};setTimeout(()=>{i({searchInfo:t})},200)}catch(t){}}return{loadingRef:n,registerTable:h,registerBpmnPreviewModal:w,registerModal:o,handlePublish:S,handleStop:P,createActions:y,handleCreate:C,handleEdit:d,cancelDeleteRole:A,handleDelete:M,handleSuccess:p,handleSelect:R,handleModelInfoVisibleChange:$}}});function pe(o,f,g,w,v,B){const l=a("FlowCategoryTree"),s=a("a-button"),n=a("TableAction"),h=a("BasicTable"),b=a("ModelInfoModal"),i=a("BpmnPreviewModal"),C=a("PageWrapper"),y=se("loading");return ie((I(),F(C,{dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"flex"},{default:u(()=>[r(l,{class:"w-1/4 xl:w-1/5",onSelect:o.handleSelect},null,8,["onSelect"]),r(h,{onRegister:o.registerTable,class:"w-3/4 xl:w-4/5"},{toolbar:u(()=>[r(s,{type:"primary",onClick:o.handleCreate},{default:u(()=>[re(" 新增 ")]),_:1},8,["onClick"])]),bodyCell:u(({column:c,record:d})=>[c.key==="action"?(I(),F(n,{key:0,actions:o.createActions(d,c)},null,8,["actions"])):ce("",!0)]),_:1},8,["onRegister"]),r(b,{onRegister:o.registerModal,onSuccess:o.handleSuccess,onVisibleChange:o.handleModelInfoVisibleChange},null,8,["onRegister","onSuccess","onVisibleChange"]),r(i,{onRegister:o.registerBpmnPreviewModal,onSuccess:o.handleSuccess},null,8,["onRegister","onSuccess"])]),_:1})),[[y,o.loadingRef]])}const Ze=J(de,[["render",pe],["__scopeId","data-v-2e452648"]]);export{Ze as default};
