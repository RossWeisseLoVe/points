var v=(t,n,a)=>new Promise((s,o)=>{var l=r=>{try{e(a.next(r))}catch(d){o(d)}},u=r=>{try{e(a.throw(r))}catch(d){o(d)}},e=r=>r.done?s(r.value):Promise.resolve(r.value).then(l,u);e((a=a.apply(t,n)).next())});import{t as I,h as x,f as z,w as m}from"./index.js";import{g as F,r as B,a4 as A,h as C,c as S,x as N,H as T,u as i,f,d as g,Z as w,a7 as y,a8 as p,E as $,a0 as k,ab as b,a6 as D,ac as E,a9 as O,N as P,ah as R,ai as j,l as V}from"./vue-f7f38239.js";import{a as q,B as H,e as L}from"./antd-bebda08e.js";function U(t,n="value",a="change",s){const o=F(),l=o==null?void 0:o.emit,u=B({value:t[n]}),e=A(u),r=c=>{u.value=c};return C(()=>{u.value=t[n]}),[S({get(){return u.value},set(c){q(c,e.value)||(u.value=c,N(()=>{l==null||l(a,c,...T(i(s))||[])}))}}),r,e]}function Z(t){const n=f(t),a=f(!1);let s;function o(){s&&window.clearInterval(s)}function l(){a.value=!1,o(),s=null}function u(){i(a)||s||(a.value=!0,s=setInterval(()=>{i(n)===1?(l(),n.value=t):n.value-=1},1e3))}function e(){n.value=t,l()}function r(){e(),u()}return I(()=>{e()}),{start:u,reset:e,restart:r,clear:o,stop:l,currentCount:n,isStart:a}}const _=g({name:"CountButton",__name:"CountButton",props:{value:{type:[Object,Number,String,Array]},count:{type:Number,default:60},beforeStartFunc:{type:Function,default:null}},setup(t){const n=t,{t:a}=x(),s=f(!1),{currentCount:o,isStart:l,start:u,reset:e}=Z(n.count),r=S(()=>i(l)?a("component.countdown.sendText",[i(o)]):a("component.countdown.normalText"));C(()=>{n.value===void 0&&e()});function d(){return v(this,null,function*(){const{beforeStartFunc:c}=n;if(c&&L(c)){s.value=!0;try{(yield c())&&u()}finally{s.value=!1}}else u()})}return(c,h)=>(w(),y(i(H),b(c.$attrs,{disabled:i(l),onClick:d,loading:s.value}),{default:p(()=>[$(k(r.value),1)]),_:1},16,["disabled","loading"]))}}),G=g({name:"CountDownInput",inheritAttrs:!1,__name:"CountdownInput",props:{value:{type:String},size:{type:String,validator:t=>["default","large","small"].includes(t)},count:{type:Number,default:60},sendCodeApi:{type:Function,default:null}},setup(t){const n=t,{prefixCls:a}=z("countdown-input"),[s]=U(n);return(o,l)=>{const u=D("a-input");return w(),y(u,b(o.$attrs,{class:i(a),size:t.size,value:i(s)}),E({addonAfter:p(()=>[V(_,{size:t.size,count:t.count,value:i(s),beforeStartFunc:t.sendCodeApi},null,8,["size","count","value","beforeStartFunc"])]),_:2},[O(Object.keys(o.$slots).filter(e=>e!=="addonAfter"),e=>({name:e,fn:p(r=>[P(o.$slots,e,R(j(r||{})))])}))]),1040,["class","size","value"])}}});const W=m(G);m(_);export{W as C,U as u};
