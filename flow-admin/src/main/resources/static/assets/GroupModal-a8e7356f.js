var v=Object.defineProperty;var _=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var B=(r,t,e)=>t in r?v(r,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):r[t]=e,M=(r,t)=>{for(var e in t||(t={}))R.call(t,e)&&B(r,e,t[e]);if(_)for(var e of _(t))$.call(t,e)&&B(r,e,t[e]);return r};var f=(r,t,e)=>new Promise((l,a)=>{var c=s=>{try{i(e.next(s))}catch(m){a(m)}},n=s=>{try{i(e.throw(s))}catch(m){a(m)}},i=s=>s.done?l(s.value):Promise.resolve(s.value).then(c,n);i((e=e.apply(r,t)).next())});import{B as P,a as k}from"./index-6bb63bf0.js";import{_ as N}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as S}from"./useForm-d2875f1c.js";import{f as V}from"./group.data-36b4110b.js";import{c as C,s as E}from"./group-57af0be4.js";import{d as G,f as L,u as g,c as O,a6 as w,Z as U,a7 as j,a8 as x,l as A,ab as D}from"./vue-f7f38239.js";import{c as T}from"./index.js";import"./antd-bebda08e.js";import"./useWindowSizeFn-01ffbee2.js";import"./index-1b9aa1da.js";import"./uuid-31b8b5a4.js";import"./useSortable-9ec2a7be.js";import"./download-2647fd8d.js";import"./base64Conver-39fc0d26.js";import"./index-b34be3ab.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-af62677b.js";import"./copyTextToClipboard-ad844e61.js";import"./index-091b1c05.js";const Z=G({name:"GroupModal",components:{BasicModal:P,BasicForm:N},emits:["success","register"],setup(r,{emit:t}){const e=L(!0),[l,{resetFields:a,updateSchema:c,setFieldsValue:n,validate:i}]=S({labelWidth:100,schemas:V,showActionButtonGroup:!1}),s=o=>[{trigger:"blur",validator:(u,h)=>h?C({id:o.id,field:o.field,fieldValue:h,fieldName:o.fieldName}).then(p=>p?Promise.resolve():Promise.reject(o.fieldName+"已存在，请修改！")).catch(p=>Promise.reject(p)):Promise.resolve()}],[m,{setModalProps:d,closeModal:y}]=k(o=>f(this,null,function*(){yield a(),d({confirmLoading:!1}),e.value=!!(o!=null&&o.isUpdate);let u=o.record;yield c([{field:"sn",dynamicRules:()=>[{required:!0,whitespace:!0,message:"标识不能为空！"},{trigger:["change","blur"],pattern:new RegExp("^[0-9a-zA-Z_]{1,}$"),type:"string",message:"请输入英文或数字！"},{trigger:["change","blur"],max:64,message:"字符长度不能大于64！"},...s({id:g(e)&&u&&u.id||"",field:"sn",fieldValue:"",fieldName:"标识"})]}]),g(e)&&n(M({},o.record))})),F=O(()=>g(e)?"修改":"新增");function b(){return f(this,null,function*(){try{const o=yield i();d({confirmLoading:!0}),yield E(o),y(),t("success")}finally{d({confirmLoading:!1})}})}return{registerModal:m,registerForm:l,getTitle:F,handleSubmit:b}}});function q(r,t,e,l,a,c){const n=w("BasicForm"),i=w("BasicModal");return U(),j(i,D(r.$attrs,{onRegister:r.registerModal,title:r.getTitle,onOk:r.handleSubmit}),{default:x(()=>[A(n,{onRegister:r.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const de=T(Z,[["render",q]]);export{de as default};
