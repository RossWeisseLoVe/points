var O=Object.defineProperty,R=Object.defineProperties;var k=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var U=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var B=(e,t,o)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,F=(e,t)=>{for(var o in t||(t={}))U.call(t,o)&&B(e,o,t[o]);if(v)for(var o of v(t))A.call(t,o)&&B(e,o,t[o]);return e},M=(e,t)=>R(e,k(t));var g=(e,t,o)=>new Promise((l,p)=>{var u=s=>{try{n(o.next(s))}catch(a){p(a)}},c=s=>{try{n(o.throw(s))}catch(a){p(a)}},n=s=>s.done?l(s.value):Promise.resolve(s.value).then(u,c);n((o=o.apply(e,t)).next())});import{B as E,a as G}from"./index-6bb63bf0.js";import{_ as I}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as N}from"./useForm-d2875f1c.js";import{s as P}from"./account.data-83659400.js";import{b as T}from"./account-1d577ee4.js";import{g as V}from"./group-57af0be4.js";import{d as W,f as _,u as b,c as Z,a6 as h,Z as j,a7 as q,a8 as S,l as w,ab as z}from"./vue-f7f38239.js";import{W as D}from"./antd-bebda08e.js";import{c as H}from"./index.js";import"./useWindowSizeFn-01ffbee2.js";import"./index-1b9aa1da.js";import"./uuid-31b8b5a4.js";import"./useSortable-9ec2a7be.js";import"./download-2647fd8d.js";import"./base64Conver-39fc0d26.js";import"./index-b34be3ab.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-af62677b.js";import"./copyTextToClipboard-ad844e61.js";import"./index-091b1c05.js";const J=W({name:"AccountModal",components:{BasicModal:E,BasicForm:I,Select:D},emits:["success","register"],setup(e,{emit:t}){const o=_(!0),l=_([]),p=_("设置组"),[u,{setFieldsValue:c,updateSchema:n,resetFields:s,validate:a}]=N({labelWidth:100,schemas:P,showActionButtonGroup:!1,actionColOptions:{span:23}}),[d,{setModalProps:m,closeModal:$}]=G(r=>g(this,null,function*(){s(),m({confirmLoading:!1,title:"给账号【"+r.record.realName+"("+r.record.username+")】设置组"}),o.value=!!(r!=null&&r.isUpdate);const f=yield V();if(f.forEach(i=>{i.label=i.name,i.value=i.id}),l.value=f,b(o)){let i=r.record.groups||[];i=i.map(L=>L.id),c(M(F({},r.record),{groups:i}))}}));let y=Z(()=>b(o)?p.value:"新增");function C(){return g(this,null,function*(){try{m({confirmLoading:!0});const r=yield a();r.groups=r.groups.map(f=>({id:f})),r.userId=r.id,delete r.id,yield T(r),$(),t("success")}finally{m({confirmLoading:!1})}})}return{registerModal:d,registerForm:u,getTitle:y,groupOptions:l,handleSubmit:C}}});function K(e,t,o,l,p,u){const c=h("Select"),n=h("BasicForm"),s=h("BasicModal");return j(),q(s,z(e.$attrs,{onRegister:e.registerModal,title:e.getTitle,onOk:e.handleSubmit}),{default:S(()=>[w(n,{onRegister:e.registerForm},{groups:S(({model:a,field:d})=>[w(c,{value:a[d],"onUpdate:value":m=>a[d]=m,mode:"multiple",style:{width:"100%"},placeholder:"请选择组","option-label-prop":"label",options:e.groupOptions},null,8,["value","onUpdate:value","options"])]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const vo=H(J,[["render",K]]);export{vo as default};
