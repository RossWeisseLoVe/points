var C=Object.defineProperty,M=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var w=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,q=Object.prototype.propertyIsEnumerable;var b=(t,o,e)=>o in t?C(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,P=(t,o)=>{for(var e in o||(o={}))B.call(o,e)&&b(t,e,o[e]);if(w)for(var e of w(o))q.call(o,e)&&b(t,e,o[e]);return t},I=(t,o)=>M(t,N(o));var f=(t,o,e)=>new Promise((i,s)=>{var d=r=>{try{n(e.next(r))}catch(m){s(m)}},c=r=>{try{n(e.throw(r))}catch(m){s(m)}},n=r=>r.done?i(r.value):Promise.resolve(r.value).then(d,c);n((e=e.apply(t,o)).next())});import{B as F,a as k}from"./index-6bb63bf0.js";import{_ as v}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as R}from"./useForm-d2875f1c.js";import{m as $,d as T,f as O,u as g,c as V,a6 as _,Z as j,a7 as A,a8 as D,l as z,ab as E}from"./vue-f7f38239.js";import{Q as L}from"./antd-bebda08e.js";import{c as U,s as Z}from"./category-90acc8cc.js";import{g as W}from"./company-7689c9fc.js";import{c as G}from"./index.js";const ie=[{title:"名称",dataIndex:"name",align:"left"},{title:"编码",dataIndex:"code",width:100,align:"left"},{title:"简称",dataIndex:"shortName",width:100,align:"left"},{title:"所属公司",dataIndex:"cName",width:100,align:"left"},{title:"前台显示",dataIndex:"frontShow",width:80,customRender:({record:t})=>{const e=~~t.frontShow===1,i=e?"green":"red",s=e?"显示":"隐藏";return $(L,{color:i},()=>s)}},{title:"排序",dataIndex:"orderNo",width:80},{title:"创建时间",dataIndex:"createTime",width:180},{title:"描述",dataIndex:"note",align:"left"}],de=[{field:"keyword",label:"关键字",component:"Input",componentProps:{placeholder:"请输入名称/编码"},labelWidth:60,colProps:{span:6,lg:{span:6,offset:0},sm:{span:10,offset:0},xs:{span:16,offset:0}}}],Q=[{field:"id",label:"ID",component:"Input",show:!1},{field:"pid",label:"pid",required:!1,component:"Input",show:!1,colProps:{span:24}},{field:"name",label:"名称",required:!0,component:"Input",rules:[{required:!0,whitespace:!0,message:"名称不能为空！"},{max:200,message:"字符长度不能大于200！"}],colProps:{span:24}},{field:"code",label:"编码",required:!0,component:"Input",colProps:{span:24}},{field:"shortName",label:"简称",required:!1,component:"Input",rules:[{whitespace:!0,message:"编码不能为空！"},{max:200,message:"字符长度不能大于200！"}],colProps:{span:24}},{field:"companyId",label:"所属公司",component:"TreeSelect",componentProps:{treeNodeFilterProp:"cname",getPopupContainer:()=>document.body},required:!0,colProps:{span:24}},{field:"orderNo",label:"排序号",required:!1,component:"InputNumber"},{field:"frontShow",label:"状态",required:!1,component:"Switch",defaultValue:!0,componentProps:{checkedChildren:"显示",unCheckedChildren:"隐藏"},colProps:{span:24}},{field:"note",label:"描述",required:!1,component:"InputTextArea",rules:[{max:400,message:"字符长度不能大于400！"}],colProps:{span:24}}],H=T({name:"CategoryModal",components:{BasicModal:F,BasicForm:v},emits:["success","register"],setup(t,{emit:o}){const e=O(!0),[i,{resetFields:s,updateSchema:d,setFieldsValue:c,validate:n}]=R({labelWidth:100,schemas:Q,showActionButtonGroup:!1}),r=a=>[{trigger:"blur",validator:(h,l)=>l?U({id:a.id,field:a.field,fieldValue:l,fieldName:a.fieldName}).then(u=>u?Promise.resolve():Promise.reject(a.fieldName+"已存在，请修改！")).catch(u=>Promise.reject(u)):Promise.resolve()}],[m,{setModalProps:p,closeModal:y}]=k(a=>f(this,null,function*(){yield s(),p({confirmLoading:!1}),e.value=!!(a!=null&&a.isUpdate);const h=yield W();d([{field:"companyId",componentProps:{treeData:h}}]);let l=a.record;yield d([{field:"code",dynamicRules:()=>[{required:!0,whitespace:!0,message:"编码不能为空！"},{pattern:new RegExp("^[a-zA-Z_]{1,}[0-9a-zA-Z_]{1,}$"),type:"string",message:"请输入英文或数字且以英文或下划线开头！"},{max:30,message:"字符长度不能大于30！"},...r({id:g(e)&&l&&l.id||"",field:"code",fieldValue:"",fieldName:"编码"})]}]),g(e)&&c(I(P({},l),{frontShow:l.frontShow===1}))})),x=V(()=>g(e)?"修改":"新增");function S(){return f(this,null,function*(){try{p({confirmLoading:!0});const a=yield n();a.frontShow=a.frontShow?1:0,yield Z(a),y(),o("success")}finally{p({confirmLoading:!1})}})}return{registerModal:m,registerForm:i,getTitle:x,handleSubmit:S}}});function J(t,o,e,i,s,d){const c=_("BasicForm"),n=_("BasicModal");return j(),A(n,E(t.$attrs,{onRegister:t.registerModal,title:t.getTitle,onOk:t.handleSubmit}),{default:D(()=>[z(c,{onRegister:t.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const K=G(H,[["render",J]]),ce=Object.freeze(Object.defineProperty({__proto__:null,default:K},Symbol.toStringTag,{value:"Module"}));export{K as C,ce as a,ie as c,de as s};
