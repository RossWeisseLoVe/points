var I=Object.defineProperty;var _=Object.getOwnPropertySymbols;var x=Object.prototype.hasOwnProperty,A=Object.prototype.propertyIsEnumerable;var y=(e,s,t)=>s in e?I(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,P=(e,s)=>{for(var t in s||(s={}))x.call(s,t)&&y(e,t,s[t]);if(_)for(var t of _(s))A.call(s,t)&&y(e,t,s[t]);return e};var g=(e,s,t)=>new Promise((n,a)=>{var d=r=>{try{i(t.next(r))}catch(c){a(c)}},l=r=>{try{i(t.throw(r))}catch(c){a(c)}},i=r=>r.done?n(r.value):Promise.resolve(r.value).then(d,l);i((t=t.apply(e,s)).next())});import{B as S,a as k}from"./index-6bb63bf0.js";import{_ as E}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as R}from"./useForm-d2875f1c.js";import{b as m,bD as $,aA as N,c as O}from"./index.js";import{F as T}from"./constantEnum-c819fa5f.js";import{d as q,f as V,u as h,c as j,a6 as B,Z as D,a7 as L,a8 as U,l as C,ab as W}from"./vue-f7f38239.js";const ae=[{title:"名称",dataIndex:"name",align:"left"},{title:"编码",dataIndex:"code",width:300,align:"left"},{title:"修改时间",dataIndex:"updateTime",width:180}],ne=[{field:"keyword",label:"关键字",component:"Input",componentProps:{placeholder:"请输入名称/编码"},labelWidth:60,colProps:{span:6,lg:{span:6,offset:0},sm:{span:10,offset:0},xs:{span:16,offset:0}}}],z=[{field:"pcode",label:"pcode",required:!1,component:"Input",show:!1},{field:"name",label:"名称",required:!0,component:"Input",rules:[{required:!0,whitespace:!0,message:"名称不能为空！"},{max:20,message:"字符长度不能大于20！"}],colProps:{span:24}},{field:"code",label:"编码",required:!0,component:"Input",colProps:{span:24}}],ie=e=>{const s=m.post({url:"/flow/base/area/getAreas",params:e});return Promise.resolve(s).then(t=>{const n=$(t,{id:"code",children:"children",pid:"pcode"});return N(n,a=>{a.children.length===0&&delete a.children},{id:"code",children:"children",pid:"pcode"}),n})},G=e=>m.post({url:"/flow/base/area/saveOrUpdate",params:e}),le=e=>m.post({url:"/flow/base/area/delete/",params:e}),H=e=>m.post({url:"/flow/base/area/checkEntityExist",params:e}),Z=q({name:"AreaModal",components:{BasicModal:S,BasicForm:E},emits:["success","register"],setup(e,{emit:s}){const t=V(!0),[n,{resetFields:a,updateSchema:d,setFieldsValue:l,validate:i}]=R({labelWidth:100,schemas:z,showActionButtonGroup:!1}),r=o=>[{trigger:"blur",validator:(p,w)=>w?H({id:o.id,field:o.field,fieldValue:w,fieldName:o.fieldName}).then(f=>f?Promise.resolve():Promise.reject(o.fieldName+"已存在，请修改！")).catch(f=>Promise.reject(f)):Promise.resolve()}],[c,{setModalProps:u,closeModal:M,changeLoading:b}]=k(o=>g(this,null,function*(){yield a(),u({confirmLoading:!1}),t.value=!!(o!=null&&o.isUpdate);let p=o.record;yield d([{field:"code",dynamicRules:()=>[{required:!0,whitespace:!0,message:"编码不能为空！"},{pattern:new RegExp(T.SN),type:"string",message:"请输入英文或数字！"},{max:10,message:"字符长度不能大于10！"},...r({id:h(t)&&p&&p.code||"",field:"code",fieldValue:"",fieldName:"标识"})]}]),h(t)&&l(P({},o.record))})),F=j(()=>h(t)?"修改":"新增");function v(){return g(this,null,function*(){b(!0);try{u({confirmLoading:!0});const o=yield i();yield G(o),M(),s("success")}finally{u({confirmLoading:!1}),b(!1)}})}return{registerModal:c,registerForm:n,getTitle:F,handleSubmit:v}}});function J(e,s,t,n,a,d){const l=B("BasicForm"),i=B("BasicModal");return D(),L(i,W(e.$attrs,{onRegister:e.registerModal,title:e.getTitle,onOk:e.handleSubmit}),{default:U(()=>[C(l,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const K=O(Z,[["render",J]]),ce=Object.freeze(Object.defineProperty({__proto__:null,default:K},Symbol.toStringTag,{value:"Module"}));export{K as A,ce as a,ae as c,le as d,ie as g,ne as s};
