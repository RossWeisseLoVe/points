var V=Object.defineProperty;var d=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var g=(o,s,e)=>s in o?V(o,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[s]=e,v=(o,s)=>{for(var e in s||(s={}))S.call(s,e)&&g(o,e,s[e]);if(d)for(var e of d(s))$.call(s,e)&&g(o,e,s[e]);return o};var f=(o,s,e)=>new Promise((c,p)=>{var m=r=>{try{a(e.next(r))}catch(i){p(i)}},l=r=>{try{a(e.throw(r))}catch(i){p(i)}},a=r=>r.done?c(r.value):Promise.resolve(r.value).then(m,l);a((e=e.apply(o,s)).next())});import{B as b,a as w}from"./index-6bb63bf0.js";import{_ as k}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as y}from"./useForm-d2875f1c.js";import{p as R,a as C}from"./module-b7c977cb.js";import{g as L}from"./appPrivilegeValue-7cf6f865.js";import{d as A,f as O,u as _,c as T,a6 as h,Z as U,a7 as E,a8 as G,l as I,ab as N}from"./vue-f7f38239.js";import{c as W}from"./index.js";import"./antd-bebda08e.js";import"./useWindowSizeFn-01ffbee2.js";import"./index-1b9aa1da.js";import"./uuid-31b8b5a4.js";import"./useSortable-9ec2a7be.js";import"./download-2647fd8d.js";import"./base64Conver-39fc0d26.js";import"./index-b34be3ab.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-af62677b.js";import"./copyTextToClipboard-ad844e61.js";import"./index-091b1c05.js";const Z=A({name:"PValueSettingModal",components:{BasicModal:b,BasicForm:k},emits:["success","register"],setup(o,{emit:s}){const e=O(!0),[c,{resetFields:p,setFieldsValue:m,updateSchema:l,validate:a}]=y({labelWidth:100,schemas:R,showActionButtonGroup:!1}),[r,{setModalProps:i,closeModal:B}]=w(t=>f(this,null,function*(){if(p(),i({confirmLoading:!1,title:"设置菜单【"+t.record.name+"】的权限值"}),e.value=!!(t!=null&&t.isUpdate),_(e)){m(v({},t.record));let u=(yield L())||[];u.forEach(n=>{n.value=n.position,n.label=n.name});const P=t.record.pvs.map(n=>n.position);l({field:"pvs",componentProps:{options:u}}),m({pvs:P})}})),M=T(()=>_(e)?"设置权限值":"新增");function F(){return f(this,null,function*(){try{i({confirmLoading:!0});const t=yield a();t.pvs=t.pvs.map(u=>({position:u})),yield C(t),B(),s("success")}finally{i({confirmLoading:!1})}})}return{registerModal:r,registerForm:c,getTitle:M,handleSubmit:F}}});function j(o,s,e,c,p,m){const l=h("BasicForm"),a=h("BasicModal");return U(),E(a,N(o.$attrs,{onRegister:o.registerModal,title:o.getTitle,onOk:o.handleSubmit}),{default:G(()=>[I(l,{onRegister:o.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const le=W(Z,[["render",j]]);export{le as default};
