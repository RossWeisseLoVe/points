import{_ as T}from"./BasicTable.vue_vue_type_script_setup_true_lang-68f7da80.js";import"./TableImg.vue_vue_type_style_index_0_lang-c025c7d6.js";import{a as y}from"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as B}from"./useTable-dd83d9cb.js";import{g as S,d as w}from"./dept-92794b55.js";import{P as M}from"./index-5a8cda67.js";import k from"./CompanyTree-d7d2dbca.js";import{a as E,c as D}from"./index.js";import{b as P}from"./index-6bb63bf0.js";import{D as A,c as F,s as I}from"./DeptModal-6587a4fb.js";import{d as R,f as $,u as x,a6 as n,Z as _,a7 as b,a8 as s,l,E as N,aa as W}from"./vue-f7f38239.js";import"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./antd-bebda08e.js";import"./useForm-d2875f1c.js";import"./uuid-31b8b5a4.js";import"./sortable.esm-4ae27e0b.js";import"./onMountedOrActivated-a837e8fb.js";import"./useWindowSizeFn-01ffbee2.js";import"./index-1b9aa1da.js";import"./useSortable-9ec2a7be.js";import"./download-2647fd8d.js";import"./base64Conver-39fc0d26.js";import"./index-b34be3ab.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-af62677b.js";import"./copyTextToClipboard-ad844e61.js";import"./index-091b1c05.js";import"./useContentViewHeight-4f74c208.js";import"./index-f9546e03.js";import"./useContextMenu-b66322cd.js";import"./company-7689c9fc.js";import"./index-d0acc860.js";import"./personal-9cdd6bd5.js";import"./OrgTree-95f059e8.js";import"./constantEnum-c819fa5f.js";const{createMessage:v}=E(),U=R({name:"DeptManagement",components:{BasicTable:T,PageWrapper:M,CompanyTree:k,DeptModal:A,TableAction:y},setup(){const[t,{openModal:i,setModalProps:r}]=P(),p=$({}),[C,{reload:a}]=B({title:"列表",api:S,columns:F,formConfig:{labelWidth:120,schemas:I,showAdvancedButton:!1,showResetButton:!1,autoSubmitOnEnter:!0},expandRowByClick:!0,useSearchForm:!0,showIndexColumn:!1,bordered:!0,pagination:!1,actionColumn:{width:150,title:"操作",dataIndex:"action"}});function c(){var e;r({title:"新增部门"}),i(!0,{record:{companyId:(e=x(p))==null?void 0:e.id},isUpdate:!1})}function m(e,o){o.stopPropagation(),r({title:"修改部门"}),i(!0,{record:e,isUpdate:!0})}function u(e,o){o.stopPropagation(),r({title:"新增【"+e.name+"】的子部门"}),e={pid:e.id},i(!0,{record:e,isUpdate:!0})}function d(e){if(e.children&&e.children.length>0){v.warning("有子节点，不能删除！");return}w([e.id]).then(o=>{a()})}function f(){a()}function h(){setTimeout(()=>{a()},200)}function g(e){p.value=e,a({searchInfo:{companyId:e?e.id:""}})}return{registerTable:C,registerModal:t,handleCreate:c,handleEdit:m,handleCreateChild:u,handleDelete:d,handleSuccess:h,handleSelect:g,doSearch:f}}});function V(t,i,r,p,C,a){const c=n("CompanyTree"),m=n("a-button"),u=n("TableAction"),d=n("BasicTable"),f=n("DeptModal"),h=n("PageWrapper");return _(),b(h,{dense:"",contentFullHeight:"",fixedHeight:"",contentClass:"flex"},{default:s(()=>[l(c,{class:"w-1/4 xl:w-1/5",onSelect:t.handleSelect},null,8,["onSelect"]),l(d,{onRegister:t.registerTable,class:"w-3/4 xl:w-4/5"},{toolbar:s(()=>[l(m,{type:"primary",onClick:t.handleCreate},{default:s(()=>[N("新增")]),_:1},8,["onClick"])]),bodyCell:s(({column:g,record:e})=>[g.key==="action"?(_(),b(u,{key:0,actions:[{tooltip:"添加子部门",icon:"ant-design:plus-outlined",onClick:t.handleCreateChild.bind(null,e)},{tooltip:"修改",icon:"clarity:note-edit-line",onClick:t.handleEdit.bind(null,e)},{tooltip:"删除",icon:"ant-design:delete-outlined",color:"error",onClick:o=>{o.stopPropagation()},popConfirm:{title:"是否确认删除",confirm:t.handleDelete.bind(null,e),placement:"left"}}]},null,8,["actions"])):W("",!0)]),_:1},8,["onRegister"]),l(f,{onRegister:t.registerModal,onSuccess:t.handleSuccess},null,8,["onRegister","onSuccess"])]),_:1})}const ye=D(U,[["render",V]]);export{ye as default};
