var S=Object.defineProperty,y=Object.defineProperties;var B=Object.getOwnPropertyDescriptors;var b=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var w=(t,s,e)=>s in t?S(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e,P=(t,s)=>{for(var e in s||(s={}))F.call(s,e)&&w(t,e,s[e]);if(b)for(var e of b(s))N.call(s,e)&&w(t,e,s[e]);return t},_=(t,s)=>y(t,B(s));var p=(t,s,e)=>new Promise((i,r)=>{var u=a=>{try{n(e.next(a))}catch(c){r(c)}},l=a=>{try{n(e.throw(a))}catch(c){r(c)}},n=a=>a.done?i(a.value):Promise.resolve(a.value).then(u,l);n((e=e.apply(t,s)).next())});import{B as k,a as v}from"./index-6bb63bf0.js";import{_ as R}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as $}from"./useForm-d2875f1c.js";import{m as C,d as V,f as O,u as g,c as T,a6 as I,Z as j,a7 as E,a8 as D,l as L,ab as U}from"./vue-f7f38239.js";import{Q as A}from"./antd-bebda08e.js";import{c as W,s as z}from"./positionSeq-6b342567.js";import{F as G}from"./constantEnum-c819fa5f.js";import{c as Q}from"./index.js";const le=[{title:"名称",dataIndex:"name",align:"left"},{title:"编码",dataIndex:"code",align:"left"},{title:"状态",dataIndex:"status",width:80,customRender:({record:t})=>{const e=~~t.status===1,i=e?"green":"red",r=e?"启用":"停用";return C(A,{color:i},()=>r)}},{title:"排序编号",dataIndex:"orderNo",width:100,align:"left"},{title:"备注",dataIndex:"note",align:"left"}],ce=[{field:"keyword",label:"关键字",component:"Input",componentProps:{placeholder:"请输入名称/编码"},labelWidth:60,colProps:{span:6,lg:{span:6,offset:0},sm:{span:10,offset:0},xs:{span:16,offset:0}}}],Z=[{field:"id",label:"ID",required:!1,component:"Input",show:!1},{field:"name",label:"名称",required:!0,component:"Input",show:!0,rules:[{required:!0,whitespace:!0,message:"名称不能为空！"},{max:80,message:"字符长度不能大于80！"}],colProps:{span:24}},{field:"code",label:"编码",required:!0,component:"Input",show:!0,colProps:{span:24}},{field:"pid",label:"父级编码",required:!1,component:"Input",show:!1},{field:"orderNo",label:"排序编号",required:!1,component:"InputNumber",show:!0},{field:"status",label:"状态",required:!1,component:"Switch",defaultValue:!0,componentProps:{checkedChildren:"启用",unCheckedChildren:"停用"},colProps:{span:24}},{field:"note",label:"备注",required:!1,component:"InputTextArea",show:!0,rules:[{max:255,message:"字符长度不能大于255！"}],colProps:{span:24}}],H=V({name:"PositionSeqModal",components:{BasicModal:k,BasicForm:R},emits:["success","register"],setup(t,{emit:s}){const e=O(!0),[i,{resetFields:r,updateSchema:u,setFieldsValue:l,validate:n}]=$({labelWidth:100,schemas:Z,showActionButtonGroup:!1}),a=o=>[{trigger:"blur",validator:(d,h)=>h?W({id:o.id,field:o.field,fieldValue:h,fieldName:o.fieldName}).then(f=>f?Promise.resolve():Promise.reject(o.fieldName+"已存在，请修改！")).catch(f=>Promise.reject(f)):Promise.resolve()}],[c,{setModalProps:m,closeModal:q}]=v(o=>p(this,null,function*(){yield r(),m({confirmLoading:!1}),e.value=!!(o!=null&&o.isUpdate);let d=o.record;yield u([{field:"code",dynamicRules:()=>[{required:!0,whitespace:!0,message:"标识不能为空！"},{pattern:new RegExp(G.SN),type:"string",message:"请输入英文或数字！"},{max:40,message:"字符长度不能大于40！"},...a({id:g(e)&&d&&d.id||"",field:"code",fieldValue:"",fieldName:"标识"})]}]),g(e)&&l(_(P({},d),{status:d.status===1}))})),x=T(()=>g(e)?"修改":"新增");function M(){return p(this,null,function*(){try{m({confirmLoading:!0});const o=yield n();o.status=o.status?1:0,yield z(o),q(),s("success")}finally{m({confirmLoading:!1})}})}return{registerModal:c,registerForm:i,getTitle:x,handleSubmit:M}}});function J(t,s,e,i,r,u){const l=I("BasicForm"),n=I("BasicModal");return j(),E(n,U(t.$attrs,{onRegister:t.registerModal,title:t.getTitle,onOk:t.handleSubmit}),{default:D(()=>[L(l,{onRegister:t.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const K=Q(H,[["render",J]]),de=Object.freeze(Object.defineProperty({__proto__:null,default:K},Symbol.toStringTag,{value:"Module"}));export{K as P,de as a,le as c,ce as s};
