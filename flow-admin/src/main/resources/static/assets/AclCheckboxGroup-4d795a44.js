var p=(e,a,l)=>new Promise((o,c)=>{var s=n=>{try{i(l.next(n))}catch(t){c(t)}},r=n=>{try{i(l.throw(n))}catch(t){c(t)}},i=n=>n.done?o(n.value):Promise.resolve(n.value).then(s,r);i((l=l.apply(e,a)).next())});import{b as h,bD as v,aA as A,p as d,c as I}from"./index.js";import{a4 as k,G as x}from"./antd-bebda08e.js";import{d as L,f as u,a6 as f,Z as m,_ as y,l as C,a8 as b,a7 as G,E as _,aa as S}from"./vue-f7f38239.js";const V=e=>{const a=h.get({url:"/flow/privilege/acl/getModuleAclsByGroupId/"+e.groupId});return Promise.resolve(a).then(l=>{const o=v(l,{id:"id",children:"children",pid:"pid"});return A(o,c=>{c.children.length===0&&delete c.children},{id:"id",children:"children",pid:"pid"}),o})},D=e=>h.post({url:`/flow/privilege/acl/setAllAcl/${e.checked}`,params:e.aclInfo}),$=e=>h.post({url:"/flow/privilege/acl/setAclByModule/"+e.checked,params:e.aclInfo}),w=e=>h.post({url:`/flow/privilege/acl/setAclModuleList/${e.moduleId}/${e.groupId}`,params:e.aclList}),B=L({name:"AclCheckboxGroup",components:{Checkbox:k,CheckboxGroup:k.Group,Spin:x},props:{checkboxList:d.arrayOf(d.object).def([]),groupId:d.string.def(""),moduleSn:d.string.def(""),moduleId:d.string.def("")},setup(e,{emit:a}){const l=e.checkboxList.filter(t=>t.checked),o=u(!1),c=u(l.length>0&&e.checkboxList.length===l.length);l.length!==0&&e.checkboxList.length!==l.length&&(o.value=!0);const s=u(!1),r=u(l.map(t=>t.value));function i(t){return p(this,null,function*(){s.value=!0,o.value=!!t.length&&t.length<e.checkboxList.length,c.value=t.length===e.checkboxList.length;const g={moduleId:e.moduleId,groupId:e.groupId,aclList:t};try{yield w(g),a("changeCheckAllStatus")}finally{s.value=!1}})}function n(t){return p(this,null,function*(){r.value=t.target.checked?e.checkboxList.map(g=>g.value):[],o.value=!1,c.value=t.target.checked,s.value=!0,yield $({checked:t.target.checked?1:0,aclInfo:{releaseId:e.groupId,moduleId:e.moduleId}}),a("changeCheckAllStatus"),s.value=!1})}return{spinning:s,indeterminate:o,checkAll:c,checkedList:r,onChange:i,onCheckAllChange:n}}});function M(e,a,l,o,c,s){const r=f("Checkbox"),i=f("CheckboxGroup"),n=f("Spin");return m(),y("div",null,[C(n,{spinning:e.spinning},{default:b(()=>[e.checkboxList&&e.checkboxList.length>0?(m(),G(r,{key:0,indeterminate:e.indeterminate,checked:e.checkAll,onChange:e.onCheckAllChange},{default:b(()=>[_(" 全选 ")]),_:1},8,["indeterminate","checked","onChange"])):S("",!0),C(i,{value:e.checkedList,"onUpdate:value":a[0]||(a[0]=t=>e.checkedList=t),options:e.checkboxList,onChange:e.onChange},null,8,["value","options","onChange"])]),_:1},8,["spinning"])])}const T=I(B,[["render",M]]),P=Object.freeze(Object.defineProperty({__proto__:null,default:T},Symbol.toStringTag,{value:"Module"}));export{T as A,P as a,V as g,D as s};
