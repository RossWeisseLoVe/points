var M=Object.defineProperty;var b=Object.getOwnPropertySymbols;var P=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var w=(e,s,t)=>s in e?M(e,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[s]=t,S=(e,s)=>{for(var t in s||(s={}))P.call(s,t)&&w(e,t,s[t]);if(b)for(var t of b(s))C.call(s,t)&&w(e,t,s[t]);return e};var y=(e,s,t)=>new Promise((i,r)=>{var f=o=>{try{n(t.next(o))}catch(d){r(d)}},l=o=>{try{n(t.throw(o))}catch(d){r(d)}},n=o=>o.done?i(o.value):Promise.resolve(o.value).then(f,l);n((t=t.apply(e,s)).next())});import{B as F,a as q}from"./index-6bb63bf0.js";import{_ as V}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as k}from"./useForm-d2875f1c.js";import{b as u,c as v}from"./index.js";import{F as I}from"./constantEnum-c819fa5f.js";import{d as R,f as K,u as m,c as O,a6 as x,Z as E,a7 as $,a8 as T,l as j,ab as z}from"./vue-f7f38239.js";const se=[{title:"名称",dataIndex:"configName",align:"left"},{title:"标识",dataIndex:"configSn",width:100,align:"left"},{title:"配置Key",dataIndex:"configKey",width:100,align:"left"},{title:"配置Value",dataIndex:"configValue",align:"left"},{title:"备注",dataIndex:"remark",align:"left"},{title:"排序",dataIndex:"configOrder",width:80},{title:"创建时间",dataIndex:"createTime",width:180}],ae=[{field:"keyword",label:"关键字",component:"Input",componentProps:{placeholder:"请输入名称/编码"},labelWidth:60,colProps:{span:6,lg:{span:6,offset:0},sm:{span:10,offset:0},xs:{span:16,offset:0}}}],L=[{field:"id",label:"ID",component:"Input",show:!1},{field:"configName",label:"名称",required:!0,component:"Input",rules:[{required:!0,whitespace:!0,message:"名称不能为空！"},{max:30,message:"字符长度不能大于30！"}]},{field:"configSn",label:"标识",required:!0,component:"Input"},{field:"configKey",label:"配置Key",required:!0,component:"Input"},{field:"configValue",label:"配置Value",component:"Input",rules:[{max:100,message:"字符长度不能大于100！"}]},{field:"configOrder",label:"排序号",required:!1,component:"InputNumber"},{field:"remark",label:"描述",required:!1,component:"InputTextArea",rules:[{max:80,message:"字符长度不能大于80！"}]}],oe=e=>{const s=e&&{pageNum:e.pageNum,pageSize:e.pageSize};let t=e||{};t&&(delete t.pageNum,delete t.pageSize);const i={query:s,entity:t};return u.post({url:"/flow/base/systemConfig/getPagerModel",params:i})},U=e=>u.post({url:"/flow/base/systemConfig/saveOrUpdate",params:e}),ne=e=>u.post({url:"/flow/base/systemConfig/delete",params:e}),D=e=>u.post({url:"/flow/base/systemConfig/checkEntityExist",params:e}),A=R({name:"SystemConfigModal",components:{BasicModal:F,BasicForm:V},emits:["success","register"],setup(e,{emit:s}){const t=K(!0),[i,{resetFields:r,updateSchema:f,setFieldsValue:l,validate:n}]=k({labelWidth:100,schemas:L,showActionButtonGroup:!1}),o=a=>[{trigger:"blur",validator:(c,h)=>h?D({id:a.id,field:a.field,fieldValue:h,fieldName:a.fieldName}).then(p=>p?Promise.resolve():Promise.reject(a.fieldName+"已存在，请修改！")).catch(p=>Promise.reject(p)):Promise.resolve()}],[d,{setModalProps:g,closeModal:_}]=q(a=>y(this,null,function*(){yield r(),g({confirmLoading:!1}),t.value=!!(a!=null&&a.isUpdate);let c=a.record;yield f([{field:"configSn",dynamicRules:()=>[{required:!0,whitespace:!0,message:"标识不能为空！"},{pattern:new RegExp(I.SN),type:"string",message:"请输入英文或数字！"},{max:60,message:"字符长度不能大于60！"},...o({id:m(t)&&c&&c.id||"",field:"configSn",fieldValue:"",fieldName:"标识"})]},{field:"configKey",dynamicRules:()=>[{required:!0,whitespace:!0,message:"配置Key不能为空！"},{pattern:new RegExp(I.SN),type:"string",message:"请输入英文或数字！"},{max:30,message:"字符长度不能大于30！"},...o({id:m(t)&&c&&c.id||"",field:"configKey",fieldValue:"",fieldName:"配置Key"})]}]),m(t)&&l(S({},a.record))})),N=O(()=>m(t)?"修改":"新增");function B(){return y(this,null,function*(){try{g({confirmLoading:!0});const a=yield n();yield U(a),_(),s("success")}finally{g({confirmLoading:!1})}})}return{registerModal:d,registerForm:i,getTitle:N,handleSubmit:B}}});function W(e,s,t,i,r,f){const l=x("BasicForm"),n=x("BasicModal");return E(),$(n,z(e.$attrs,{onRegister:e.registerModal,title:e.getTitle,onOk:e.handleSubmit}),{default:T(()=>[j(l,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const G=v(A,[["render",W]]),ie=Object.freeze(Object.defineProperty({__proto__:null,default:G},Symbol.toStringTag,{value:"Module"}));export{G as S,ie as a,se as c,ne as d,oe as g,ae as s};
