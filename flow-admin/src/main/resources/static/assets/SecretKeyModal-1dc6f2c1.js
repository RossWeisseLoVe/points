var T=Object.defineProperty;var k=Object.getOwnPropertySymbols;var w=Object.prototype.hasOwnProperty,P=Object.prototype.propertyIsEnumerable;var M=(t,r,e)=>r in t?T(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,K=(t,r)=>{for(var e in r||(r={}))w.call(r,e)&&M(t,e,r[e]);if(k)for(var e of k(r))P.call(r,e)&&M(t,e,r[e]);return t};var h=(t,r,e)=>new Promise((u,p)=>{var d=s=>{try{a(e.next(s))}catch(n){p(n)}},f=s=>{try{a(e.throw(s))}catch(n){p(n)}},a=s=>s.done?u(s.value):Promise.resolve(s.value).then(d,f);a((e=e.apply(t,r)).next())});import{B as b,a as D}from"./index-6bb63bf0.js";import{_ as R}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as V}from"./useForm-d2875f1c.js";import{s as E}from"./app.data-d7596be6.js";import{r as L}from"./app-72ac4173.js";import{c as N}from"./copyTextToClipboard-ad844e61.js";import{a as U,c as H}from"./index.js";import{B as O,E as A,Y as Q,P as x,bk as I}from"./antd-bebda08e.js";import{d as G,f as $,u as v,c as W,a6 as l,Z as _,a7 as S,a8 as c,l as m,E as y,a0 as Y,$ as Z,_ as j,aa as q,ab as z}from"./vue-f7f38239.js";import"./useWindowSizeFn-01ffbee2.js";import"./index-1b9aa1da.js";import"./uuid-31b8b5a4.js";import"./useSortable-9ec2a7be.js";import"./download-2647fd8d.js";import"./base64Conver-39fc0d26.js";import"./index-b34be3ab.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-af62677b.js";import"./index-091b1c05.js";const{TextArea:J}=A,X=G({name:"SecretKeyModal",components:{BasicModal:b,BasicForm:R,Button:O,Input:A,TextArea:J,Space:Q,Popconfirm:x,QuestionCircleOutlined:I},emits:["success","register"],setup(t,{emit:r}){const e=$(!0),u=$(""),{createMessage:p}=U(),[d,{resetFields:f,setFieldsValue:a}]=V({labelWidth:150,schemas:E,showActionButtonGroup:!1}),[s,{setModalProps:n}]=D(o=>h(this,null,function*(){yield f(),n({confirmLoading:!1}),e.value=!!(o!=null&&o.isUpdate);let i=o.record;u.value=i.secretKey,v(e)&&a(K({},o.record))})),g=W(()=>v(e)?"修改":"新增");function B(o){return h(this,null,function*(){try{n({confirmLoading:!0});const i=yield L(o.id);u.value=i,a({secretKey:i})}finally{n({confirmLoading:!1})}})}function C(){try{const o=v(u);if(!o){p.warning("请重新获取密钥！");return}N(o)}finally{n({confirmLoading:!1})}}return{registerModal:s,registerForm:d,getTitle:g,handleCopy:C,refreshSecretKeyHandle:B}}}),ee={class:""},oe={key:0};function te(t,r,e,u,p,d){const f=l("TextArea"),a=l("a-button"),s=l("QuestionCircleOutlined"),n=l("Popconfirm"),g=l("Space"),B=l("BasicForm"),C=l("BasicModal");return _(),S(C,z(t.$attrs,{onRegister:t.registerModal,title:t.getTitle}),{default:c(()=>[m(B,{onRegister:t.registerForm},{snSlot:c(({model:o,field:i})=>[y(Y(o[i]),1)]),secretKeySlot:c(({model:o,field:i})=>[Z("div",ee,[m(f,{readonly:"",rows:3,value:o[i],"onUpdate:value":F=>o[i]=F},null,8,["value","onUpdate:value"]),m(g,{class:"mt-2"},{default:c(()=>[o.sn!=="portal"?(_(),j("span",oe,[o[i]?(_(),S(n,{key:1,title:"确定要重新生成秘钥吗？",onConfirm:F=>t.refreshSecretKeyHandle(o)},{icon:c(()=>[m(s,{style:{color:"red"}})]),default:c(()=>[m(a,null,{default:c(()=>[y(" 更新密钥 ")]),_:1})]),_:2},1032,["onConfirm"])):(_(),S(a,{key:0,onClick:F=>t.refreshSecretKeyHandle(o)},{default:c(()=>[y(" 生成密钥 ")]),_:2},1032,["onClick"]))])):q("",!0),m(a,{type:"primary",onClick:t.handleCopy},{default:c(()=>[y(" 复制 ")]),_:1},8,["onClick"])]),_:2},1024)])]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title"])}const Se=H(X,[["render",te]]);export{Se as default};
