var L=Object.defineProperty,O=Object.defineProperties;var U=Object.getOwnPropertyDescriptors;var h=Object.getOwnPropertySymbols;var k=Object.prototype.hasOwnProperty,C=Object.prototype.propertyIsEnumerable;var B=(o,s,e)=>s in o?L(o,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):o[s]=e,v=(o,s)=>{for(var e in s||(s={}))k.call(s,e)&&B(o,e,s[e]);if(h)for(var e of h(s))C.call(s,e)&&B(o,e,s[e]);return o},F=(o,s)=>O(o,U(s));var g=(o,s,e)=>new Promise((l,m)=>{var p=r=>{try{i(e.next(r))}catch(n){m(n)}},u=r=>{try{i(e.throw(r))}catch(n){m(n)}},i=r=>r.done?l(r.value):Promise.resolve(r.value).then(p,u);i((e=e.apply(o,s)).next())});import{B as R,a as E}from"./index-6bb63bf0.js";import{_ as G}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as I}from"./useForm-d2875f1c.js";import{s as N}from"./group.data-36b4110b.js";import{e as P}from"./account-1d577ee4.js";import{a as T}from"./group-57af0be4.js";import{d as V,f as M,u as S,c as W,a6 as _,Z,a7 as j,a8 as b,l as w,ab as q}from"./vue-f7f38239.js";import{W as z}from"./antd-bebda08e.js";import{c as D}from"./index.js";import"./useWindowSizeFn-01ffbee2.js";import"./index-1b9aa1da.js";import"./uuid-31b8b5a4.js";import"./useSortable-9ec2a7be.js";import"./download-2647fd8d.js";import"./base64Conver-39fc0d26.js";import"./index-b34be3ab.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-af62677b.js";import"./copyTextToClipboard-ad844e61.js";import"./index-091b1c05.js";const H=V({name:"SetAccountModal",components:{BasicModal:R,BasicForm:G,Select:z},emits:["success","register"],setup(o,{emit:s}){const e=M(!0),l=M([]),[m,{setFieldsValue:p,updateSchema:u,resetFields:i,validate:r}]=I({labelWidth:100,schemas:N,showActionButtonGroup:!1,actionColOptions:{span:23}}),[n,{setModalProps:c,closeModal:f}]=E(t=>g(this,null,function*(){i(),c({confirmLoading:!1,title:"给组【"+t.record.name+"("+t.record.sn+")】分配用户"}),e.value=!!(t!=null&&t.isUpdate);const d=yield P();if(d.forEach(a=>{a.label=a.realName+"("+a.username+")",a.value=a.id}),l.value=d,S(e)){let a=t.record.users||[];a=a.map(A=>A.id),p(F(v({},t.record),{users:a}))}}));let $=W(()=>S(e)?"修改":"新增");function y(){return g(this,null,function*(){try{c({confirmLoading:!0});const t=yield r();t.users=t.users.map(d=>({id:d})),t.groupId=t.id,delete t.id,yield T(t),f(),s("success")}finally{c({confirmLoading:!1})}})}return{registerModal:n,registerForm:m,getTitle:$,accountOptions:l,handleSubmit:y}}});function J(o,s,e,l,m,p){const u=_("Select"),i=_("BasicForm"),r=_("BasicModal");return Z(),j(r,q(o.$attrs,{onRegister:o.registerModal,title:o.getTitle,onOk:o.handleSubmit}),{default:b(()=>[w(i,{onRegister:o.registerForm},{users:b(({model:n,field:c})=>[w(u,{value:n[c],"onUpdate:value":f=>n[c]=f,mode:"multiple",style:{width:"100%"},placeholder:"请选择用户","option-label-prop":"label",options:o.accountOptions},null,8,["value","onUpdate:value","options"])]),_:1},8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const _e=D(H,[["render",J]]);export{_e as default};
