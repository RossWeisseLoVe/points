var b=(t,l,n)=>new Promise((m,d)=>{var f=o=>{try{a(n.next(o))}catch(i){d(i)}},s=o=>{try{a(n.throw(o))}catch(i){d(i)}},a=o=>o.done?m(o.value):Promise.resolve(o.value).then(f,s);a((n=n.apply(t,l)).next())});import{_ as T}from"./BasicTable.vue_vue_type_script_setup_true_lang-68f7da80.js";import"./TableImg.vue_vue_type_style_index_0_lang-c025c7d6.js";import{a as k}from"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as E}from"./useTable-dd83d9cb.js";import{g as P,b as S,d as y,e as V}from"./module-b7c977cb.js";import{a as A,c as R}from"./index.js";import w from"./ModuleModal-830860c4.js";import F from"./PValueSettingModal-74bc7588.js";import{b as _}from"./index-6bb63bf0.js";import{d as $,x as v,a6 as r,Z as B,_ as D,l as p,a8 as h,E as U,a7 as I,aa as N}from"./vue-f7f38239.js";import"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./antd-bebda08e.js";import"./useForm-d2875f1c.js";import"./uuid-31b8b5a4.js";import"./sortable.esm-4ae27e0b.js";import"./onMountedOrActivated-a837e8fb.js";import"./useWindowSizeFn-01ffbee2.js";import"./index-1b9aa1da.js";import"./useSortable-9ec2a7be.js";import"./download-2647fd8d.js";import"./base64Conver-39fc0d26.js";import"./index-b34be3ab.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-af62677b.js";import"./copyTextToClipboard-ad844e61.js";import"./index-091b1c05.js";import"./appPrivilegeValue-7cf6f865.js";const{createMessage:x}=A(),O=$({name:"Module",components:{BasicTable:T,TableAction:k,ModuleModal:w,PValueSettingModal:F},setup(){const[t,{openModal:l,setModalProps:n}]=_(),[m,{openModal:d}]=_(),[f,{reload:s,expandAll:a}]=E({title:"列表",api:P,columns:S,isTreeTable:!0,formConfig:{labelWidth:120,schemas:y,showAdvancedButton:!1,showResetButton:!1,autoSubmitOnEnter:!0},expandRowByClick:!0,canColDrag:!0,useSearchForm:!0,pagination:!1,bordered:!0,showIndexColumn:!1,actionColumn:{width:170,title:"操作",dataIndex:"action"}});v(()=>{setTimeout(()=>{a()},1e3)});function o(e){n({title:"新增菜单"}),l(!0,{record:e,isUpdate:!1})}function i(e,c){c.stopPropagation(),n({title:"新增【"+e.name+"】的子菜单"}),e={pid:e.id},l(!0,{record:e,isUpdate:!0})}function g(e,c){c.stopPropagation(),d(!0,{record:e,isUpdate:!0})}function M(e,c){c.stopPropagation(),n({title:"修改菜单"}),l(!0,{record:e,isUpdate:!0})}function C(e){if(e.children&&e.children.length>0){x.warning("有子节点，不能删除！");return}V([e.id]).then(()=>{s()})}function u(){return b(this,null,function*(){setTimeout(()=>{s()},200),setTimeout(()=>{a()},100)})}return{registerTable:f,registerModal:t,registerPValueModal:m,handleCreate:o,handleEdit:M,handleEditPValue:g,handleCreateChild:i,handleDelete:C,handleSuccess:u}}});function W(t,l,n,m,d,f){const s=r("a-button"),a=r("Authority"),o=r("TableAction"),i=r("BasicTable"),g=r("ModuleModal"),M=r("PValueSettingModal");return B(),D("div",null,[p(i,{onRegister:t.registerTable},{toolbar:h(()=>[p(a,{value:"Module:0"},{default:h(()=>[p(s,{type:"primary",onClick:t.handleCreate},{default:h(()=>[U(" 新增 ")]),_:1},8,["onClick"])]),_:1})]),bodyCell:h(({column:C,record:u})=>[C.key==="action"?(B(),I(o,{key:0,actions:[{auth:"Module:0",tooltip:"添加子菜单",icon:"ant-design:plus-outlined",onClick:t.handleCreateChild.bind(null,u)},{auth:"Module:6",tooltip:"设置权限值",icon:"ant-design:setting-outlined",onClick:t.handleEditPValue.bind(null,u)},{auth:"Module:2",tooltip:"修改",icon:"clarity:note-edit-line",onClick:t.handleEdit.bind(null,u)},{auth:"Module:3",tooltip:"删除",icon:"ant-design:delete-outlined",color:"error",onClick:e=>{e.stopPropagation()},popConfirm:{title:"是否确认删除",confirm:t.handleDelete.bind(null,u),placement:"left"}}]},null,8,["actions"])):N("",!0)]),_:1},8,["onRegister"]),p(g,{onRegister:t.registerModal,onSuccess:t.handleSuccess},null,8,["onRegister","onSuccess"]),p(M,{onRegister:t.registerPValueModal,onSuccess:t.handleSuccess},null,8,["onRegister","onSuccess"])])}const he=R(O,[["render",W]]);export{he as default};
