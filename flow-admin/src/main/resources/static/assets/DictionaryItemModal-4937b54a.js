var P=Object.defineProperty;var h=Object.getOwnPropertySymbols;var R=Object.prototype.hasOwnProperty,I=Object.prototype.propertyIsEnumerable;var _=(t,r,e)=>r in t?P(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e,y=(t,r)=>{for(var e in r||(r={}))R.call(r,e)&&_(t,e,r[e]);if(h)for(var e of h(r))I.call(r,e)&&_(t,e,r[e]);return t};var f=(t,r,e)=>new Promise((c,a)=>{var l=i=>{try{s(e.next(i))}catch(m){a(m)}},n=i=>{try{s(e.throw(i))}catch(m){a(m)}},s=i=>i.done?c(i.value):Promise.resolve(i.value).then(l,n);s((e=e.apply(t,r)).next())});import{B as N,a as $}from"./index-6bb63bf0.js";import{_ as b}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as k}from"./useForm-d2875f1c.js";import{d as D,c as S,s as V}from"./dictionary-0bba14e5.js";import{F as C}from"./constantEnum-c819fa5f.js";import{d as E,f as O,u as B,c as L,a6 as F,Z as U,a7 as j,a8 as x,l as T,ab as q}from"./vue-f7f38239.js";import{c as A}from"./index.js";import"./antd-bebda08e.js";import"./useWindowSizeFn-01ffbee2.js";import"./index-1b9aa1da.js";import"./uuid-31b8b5a4.js";import"./useSortable-9ec2a7be.js";import"./download-2647fd8d.js";import"./base64Conver-39fc0d26.js";import"./index-b34be3ab.js";import"./IconPicker.vue_vue_type_script_setup_true_lang-af62677b.js";import"./copyTextToClipboard-ad844e61.js";import"./index-091b1c05.js";const G=E({name:"DictionaryItemModal",components:{BasicModal:N,BasicForm:b},emits:["success","register"],setup(t,{emit:r}){const e=O(!0),[c,{setFieldsValue:a,updateSchema:l,resetFields:n,validate:s}]=k({labelWidth:100,schemas:D,showActionButtonGroup:!1,actionColOptions:{span:23}}),i=o=>[{trigger:"blur",validator:(p,g)=>g?S({id:o.id,field:o.field,fieldValue:g,fieldName:o.fieldName}).then(u=>u?Promise.resolve():Promise.reject(o.fieldName+"已存在，请修改！")).catch(u=>Promise.reject(u)):Promise.resolve()}],[m,{setModalProps:d,closeModal:M}]=$(o=>f(this,null,function*(){yield n(),d({confirmLoading:!1}),e.value=!!(o!=null&&o.isUpdate);let p=o.record;yield l([{field:"code",dynamicRules:()=>[{required:!0,whitespace:!0,message:"名称不能为空！"},{pattern:new RegExp(C.SN),type:"string",message:"请输入英文或数字！"},{max:32,message:"字符长度不能大于32！"},...i({id:B(e)&&p&&p.id||"",field:"code",fieldValue:"",fieldName:"编码"})]}]),a(y({},o.record))})),w=L(()=>B(e)?"修改":"新增");function v(){return f(this,null,function*(){try{d({confirmLoading:!0});const o=yield s();yield V(o),M(),r("success")}finally{d({confirmLoading:!1})}})}return{registerModal:m,registerForm:c,getTitle:w,handleSubmit:v}}});function W(t,r,e,c,a,l){const n=F("BasicForm"),s=F("BasicModal");return U(),j(s,q(t.$attrs,{onRegister:t.registerModal,title:t.getTitle,onOk:t.handleSubmit}),{default:x(()=>[T(n,{onRegister:t.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const pe=A(G,[["render",W]]);export{pe as default};
