var F=Object.defineProperty;var h=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var I=(t,a,e)=>a in t?F(t,a,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[a]=e,b=(t,a)=>{for(var e in a||(a={}))N.call(a,e)&&I(t,e,a[e]);if(h)for(var e of h(a))R.call(a,e)&&I(t,e,a[e]);return t};var g=(t,a,e)=>new Promise((d,r)=>{var c=s=>{try{n(e.next(s))}catch(l){r(l)}},i=s=>{try{n(e.throw(s))}catch(l){r(l)}},n=s=>s.done?d(s.value):Promise.resolve(s.value).then(c,i);n((e=e.apply(t,a)).next())});import{B as M,a as B}from"./index-6bb63bf0.js";import{_ as v}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as S}from"./useForm-d2875f1c.js";import{c as k,s as q}from"./role-b83ceaa0.js";import{g as C}from"./company-7689c9fc.js";import{F as $}from"./constantEnum-c819fa5f.js";import{d as O,f as T,u as w,c as V,a6 as P,Z as j,a7 as D,a8 as E,l as L,ab as U}from"./vue-f7f38239.js";import{c as A}from"./index.js";const se=[{title:"名称",dataIndex:"name",align:"left"},{title:"编码",dataIndex:"sn",width:120,align:"left"},{title:"所属公司",dataIndex:"companyName",width:120,align:"left"},{title:"创建时间",dataIndex:"createTime",width:180},{title:"操作",dataIndex:"action",width:120}],ne=[{title:"操作",dataIndex:"action",width:50,slots:{customRender:"action"}},{dataIndex:"name",align:"left",width:200,slots:{title:"customName"},customRender:({record:t})=>t.name+" - ["+t.code+"]"},{title:"所属公司",dataIndex:"companyName",align:"left"},{title:"所属部门",dataIndex:"deptName",align:"left"}],re=[{field:"keyword",label:"关键字",component:"Input",componentProps:{placeholder:"请输入名称/标识"},labelWidth:60,colProps:{span:6,lg:{span:8,offset:0},sm:{span:14,offset:0},xs:{span:16,offset:0}}}],W=[{field:"id",label:"ID",required:!1,component:"Input",show:!1},{field:"name",label:"名称",component:"Input",required:!0,rules:[{required:!0,whitespace:!0,message:"编码不能为空！"},{max:64,message:"字符长度不能大于64！"}],colProps:{span:24}},{field:"sn",label:"编码",component:"Input",required:!0,colProps:{span:24}},{field:"companyId",label:"所属公司",component:"TreeSelect",componentProps:{treeNodeFilterProp:"cname",replaceFields:{title:"cname",key:"id",value:"id"},getPopupContainer:()=>document.body},required:!0,colProps:{span:24}},{field:"orderNo",label:"排序号",required:!1,component:"InputNumber"},{label:"备注",field:"note",component:"InputTextArea",rules:[{max:1024,message:"字符长度不能大于1024！"}],colProps:{span:24}}],z=O({name:"RoleModal",components:{BasicModal:M,BasicForm:v},emits:["success","register"],setup(t,{emit:a}){const e=T(!0),[d,{setFieldsValue:r,updateSchema:c,resetFields:i,validate:n}]=S({labelWidth:100,schemas:W,showActionButtonGroup:!1,actionColOptions:{span:23}}),s=o=>[{trigger:"blur",validator:(m,p)=>p?k({id:o.id,field:o.field,fieldValue:p,fieldName:o.fieldName}).then(f=>f?Promise.resolve():Promise.reject(o.fieldName+"已存在，请修改！")).catch(f=>Promise.reject(f)):Promise.resolve()}],[l,{setModalProps:u,closeModal:y}]=B(o=>g(this,null,function*(){yield i(),u({confirmLoading:!1}),e.value=!!(o!=null&&o.isUpdate);let m=o.record;const p=yield C();yield c([{field:"companyId",componentProps:{treeData:p}},{field:"sn",dynamicRules:()=>[{required:!0,whitespace:!0,message:"编码不能为空！"},{pattern:new RegExp($.SN),type:"string",message:"请输入英文或数字！"},{max:64,message:"字符长度不能大于64！"},...s({id:w(e)&&m&&m.id||"",field:"sn",fieldValue:"",fieldName:"编码"})]}]),r(b({},m))})),_=V(()=>w(e)?"修改":"新增");function x(){return g(this,null,function*(){try{u({confirmLoading:!0});const o=yield n();yield q(o),y(),a("success")}finally{u({confirmLoading:!1})}})}return{registerModal:l,registerForm:d,getTitle:_,handleSubmit:x}}});function G(t,a,e,d,r,c){const i=P("BasicForm"),n=P("BasicModal");return j(),D(n,U(t.$attrs,{onRegister:t.registerModal,title:t.getTitle,onOk:t.handleSubmit}),{default:E(()=>[L(i,{onRegister:t.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const Z=A(z,[["render",G]]),ie=Object.freeze(Object.defineProperty({__proto__:null,default:Z},Symbol.toStringTag,{value:"Module"}));export{Z as R,ie as a,se as c,ne as p,re as s};
