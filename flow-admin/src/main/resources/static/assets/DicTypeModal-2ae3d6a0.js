var B=Object.defineProperty;var _=Object.getOwnPropertySymbols;var F=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var b=(t,o,e)=>o in t?B(t,o,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[o]=e,w=(t,o)=>{for(var e in o||(o={}))F.call(o,e)&&b(t,e,o[e]);if(_)for(var e of _(o))N.call(o,e)&&b(t,e,o[e]);return t};var p=(t,o,e)=>new Promise((c,i)=>{var d=r=>{try{a(e.next(r))}catch(l){i(l)}},n=r=>{try{a(e.throw(r))}catch(l){i(l)}},a=r=>r.done?c(r.value):Promise.resolve(r.value).then(d,n);a((e=e.apply(t,o)).next())});import{B as v,a as x}from"./index-6bb63bf0.js";import{_ as S}from"./BasicForm.vue_vue_type_script_setup_true_lang-b5fd2c2d.js";import"./BasicForm.vue_vue_type_style_index_0_lang-1d0165cd.js";import{u as D}from"./useForm-d2875f1c.js";import{c as R,s as k}from"./dicType-916f1d40.js";import{F as q}from"./constantEnum-c819fa5f.js";import{d as T,f as $,u as g,c as O,a6 as y,Z as V,a7 as j,a8 as E,l as C,ab as G}from"./vue-f7f38239.js";import{c as L}from"./index.js";const oe=[{title:"名称",dataIndex:"name",align:"left"},{title:"编码",dataIndex:"code",align:"left"},{title:"排序",dataIndex:"orderNo",width:100},{title:"创建时间",dataIndex:"createTime",width:180}],se=[{field:"keyword",label:"关键字",component:"Input",componentProps:{placeholder:"请输入名称/编码"},labelWidth:60,colProps:{span:6,lg:{span:6,offset:0},sm:{span:10,offset:0},xs:{span:16,offset:0}}}],U=[{field:"id",label:"ID",component:"Input",show:!1},{field:"pid",label:"pid",required:!1,component:"Input",show:!1},{field:"name",label:"名称",required:!0,component:"Input",rules:[{required:!0,whitespace:!0,message:"名称不能为空！"},{max:64,message:"字符长度不能大于64！"}],colProps:{span:24}},{field:"code",label:"编码",required:!0,component:"Input",colProps:{span:24}},{field:"orderNo",label:"排序号",required:!1,component:"InputNumber"}],W=T({name:"DicTypeModal",components:{BasicModal:v,BasicForm:S},emits:["success","register"],setup(t,{emit:o}){const e=$(!0),[c,{resetFields:i,updateSchema:d,setFieldsValue:n,validate:a}]=D({labelWidth:100,schemas:U,showActionButtonGroup:!1}),r=s=>[{trigger:"blur",validator:(u,h)=>h?R({id:s.id,field:s.field,fieldValue:h,fieldName:s.fieldName}).then(f=>f?Promise.resolve():Promise.reject(s.fieldName+"已存在，请修改！")).catch(f=>Promise.reject(f)):Promise.resolve()}],[l,{setModalProps:m,closeModal:I}]=x(s=>p(this,null,function*(){yield i(),m({confirmLoading:!1}),e.value=!!(s!=null&&s.isUpdate);let u=s.record;yield d([{field:"code",dynamicRules:()=>[{required:!0,whitespace:!0,message:"编码不能为空！"},{pattern:new RegExp(q.SN),type:"string",message:"请输入英文或数字！"},{max:64,message:"字符长度不能大于64！"},...r({id:g(e)&&u&&u.id||"",field:"code",fieldValue:"",fieldName:"编码"})]}]),g(e)&&n(w({},s.record))})),M=O(()=>g(e)?"修改":"新增");function P(){return p(this,null,function*(){try{m({confirmLoading:!0});const s=yield a();yield k(s),I(),o("success")}finally{m({confirmLoading:!1})}})}return{registerModal:l,registerForm:c,getTitle:M,handleSubmit:P}}});function z(t,o,e,c,i,d){const n=y("BasicForm"),a=y("BasicModal");return V(),j(a,G(t.$attrs,{onRegister:t.registerModal,title:t.getTitle,onOk:t.handleSubmit}),{default:E(()=>[C(n,{onRegister:t.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}const A=L(W,[["render",z]]),re=Object.freeze(Object.defineProperty({__proto__:null,default:A},Symbol.toStringTag,{value:"Module"}));export{re as D,A as G,oe as c,se as s};
